
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Running Tune experiments with BOHB &#8212; Ray 3.0.0.dev0</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css@digest=5115cc725059bd94278eecd172e13a965bf8f5a9.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_/static/css/badge_only.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/versionwarning.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../../_static/js/docsearch.js"></script>
    <script src="../../_static/js/rate-the-docs.es.min.js"></script>
    <script defer="defer" src="../../_static/js/termynal.js"></script>
    <script defer="defer" src="../../_static/js/custom.js"></script>
    <script defer="defer" src="../../_static/js/top-navigation.js"></script>
    <script src="../../_static/js/tags.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js@digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="../../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/tune/examples/bohb_example.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Running Tune experiments with Nevergrad" href="nevergrad_example.html" />
    <link rel="prev" title="Running Tune experiments with BlendSearch and CFO" href="flaml_example.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  
<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": true, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "tune/examples/bohb_example", "programming_language": "py", "project": "ray", "proxied_api_host": "/_", "source_suffix": ".ipynb", "subprojects": {}, "theme": "sphinx_book_theme", "user_analytics_code": "", "version": "master"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 3.0.0.dev0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Welcome to Ray!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/index.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-more-libs/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/use-cases.html">
   Use Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/examples.html">
   Example Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/ray-libraries.html">
   Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-core/walkthrough.html">
   Ray Core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-air/getting-started.html">
   Ray AI Runtime (AIR)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/data.html">
   Ray Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../train/train.html">
   Ray Train
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../tune.html">
   Ray Tune
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../getting-started.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../key-concepts.html">
     Key Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/overview.html">
     User Guides
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="index.html">
     Ray Tune Examples
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="ml-frameworks.html">
       Examples using Ray Tune with ML Frameworks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="experiment-tracking.html">
       Tune Experiment Tracking Examples
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="hpo-frameworks.html">
       Tune Hyperparameter Optimization Framework Examples
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="ax_example.html">
         Ax Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="dragonfly_example.html">
         Dragonfly Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="skopt_example.html">
         Skopt Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="hyperopt_example.html">
         HyperOpt Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="bayesopt_example.html">
         Bayesopt Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="flaml_example.html">
         FLAML Example
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="bohb_example.html#">
         BOHB Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="nevergrad_example.html">
         Nevergrad Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="optuna_example.html">
         Optuna Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="zoopt_example.html">
         ZOOpt Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="sigopt_example.html">
         SigOpt Example
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="hebo_example.html">
         HEBO Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="other-examples.html">
       Other Examples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="exercises.html">
       Exercises
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faq.html">
     Ray Tune FAQ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/api.html">
     Ray Tune API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../serve/index.html">
   Ray Serve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rllib/index.html">
   Ray RLlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-more-libs/index.html">
   More Libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-core/cluster/index.html">
   Ray Clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-observability/index.html">
   Monitoring and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-references/api.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-contribute/stability.html">
   Developer Guides
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Ftune/examples/bohb_example.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/tune/examples/bohb_example.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/tune/examples/bohb_example.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="bohb_example.html#optional-passing-the-search-space-via-the-tunebohb-algorithm">
   Optional: Passing the search space via the TuneBOHB algorithm
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Running Tune experiments with BOHB</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="bohb_example.html#optional-passing-the-search-space-via-the-tunebohb-algorithm">
   Optional: Passing the search space via the TuneBOHB algorithm
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="running-tune-experiments-with-bohb">
<h1>Running Tune experiments with BOHB<a class="headerlink" href="bohb_example.html#running-tune-experiments-with-bohb" title="Permalink to this headline">#</a></h1>
<p>In this tutorial we introduce BOHB, while running a simple Ray Tune experiment.
Tune’s Search Algorithms integrate with BOHB and, as a result,
allow you to seamlessly scale up a BOHB optimization
process - without sacrificing performance.</p>
<p>Bayesian Optimization HyperBand (BOHB) combines the benefits of Bayesian optimization
together with Bandit-based methods (e.g. HyperBand). BOHB does not rely on
the gradient of the objective function,
but instead, learns from samples of the search space.
It is suitable for optimizing functions that are non-differentiable,
with many local minima, or even unknown but only testable.
Therefore, this approach belongs to the domain of
“derivative-free optimization” and “black-box optimization”.</p>
<p>In this example we minimize a simple objective to briefly demonstrate the usage of
BOHB with Ray Tune via <code class="docutils literal notranslate"><span class="pre">BOHBSearch</span></code>. It’s useful to keep in mind that despite
the emphasis on machine learning experiments, Ray Tune optimizes any implicit
or explicit objective. Here we assume <code class="docutils literal notranslate"><span class="pre">ConfigSpace==0.4.18</span></code> and <code class="docutils literal notranslate"><span class="pre">hpbandster==0.7.4</span></code>
libraries are installed. To learn more, please refer to the
<a class="reference external" href="https://github.com/automl/HpBandSter">BOHB website</a>.</p>
<p>Click below to see all the imports we need for this example.
You can also launch directly into a Binder instance to run this notebook yourself.
Just click on the rocket symbol at the top of the navigation.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">ray</span>
<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">air</span><span class="p">,</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.air</span> <span class="kn">import</span> <span class="n">session</span>
<span class="kn">from</span> <span class="nn">ray.tune.schedulers.hb_bohb</span> <span class="kn">import</span> <span class="n">HyperBandForBOHB</span>
<span class="kn">from</span> <span class="nn">ray.tune.search.bohb</span> <span class="kn">import</span> <span class="n">TuneBOHB</span>
<span class="kn">import</span> <span class="nn">ConfigSpace</span> <span class="k">as</span> <span class="nn">CS</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s start by defining a simple evaluation function.
We artificially sleep for a bit (<code class="docutils literal notranslate"><span class="pre">0.1</span></code> seconds) to simulate a long-running ML experiment.
This setup assumes that we’re running multiple <code class="docutils literal notranslate"><span class="pre">step</span></code>s of an experiment and try to tune
two hyperparameters, namely <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code>, and <code class="docutils literal notranslate"><span class="pre">activation</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">activation</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">activation_boost</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="n">activation</span><span class="o">==</span><span class="s2">&quot;relu&quot;</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">height</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">activation_boost</span>
</pre></div>
</div>
</div>
</div>
<p>Next, our <code class="docutils literal notranslate"><span class="pre">objective</span></code> function takes a Tune <code class="docutils literal notranslate"><span class="pre">config</span></code>, evaluates the <code class="docutils literal notranslate"><span class="pre">score</span></code> of your
experiment in a training loop, and uses <code class="docutils literal notranslate"><span class="pre">session.report</span></code> to report the <code class="docutils literal notranslate"><span class="pre">score</span></code> back to Tune.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;steps&quot;</span><span class="p">]):</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;activation&quot;</span><span class="p">])</span>
        <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">({</span><span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="n">step</span><span class="p">,</span> <span class="s2">&quot;mean_loss&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Next we define a search space. The critical assumption is that the optimal
hyperparameters live within this space. Yet, if the space is very large,
then those hyperparameters may be difficult to find in a short amount of time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_space</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">]),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Next we define the search algorithm built from <code class="docutils literal notranslate"><span class="pre">TuneBOHB</span></code>, constrained
to a maximum of <code class="docutils literal notranslate"><span class="pre">4</span></code> concurrent trials with a <code class="docutils literal notranslate"><span class="pre">ConcurrencyLimiter</span></code>.
Below <code class="docutils literal notranslate"><span class="pre">algo</span></code> will take care of the BO (Bayesian optimization) part of BOHB,
while scheduler will take care the HB (HyperBand) part.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">TuneBOHB</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">ConcurrencyLimiter</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">max_concurrent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">HyperBandForBOHB</span><span class="p">(</span>
    <span class="n">time_attr</span><span class="o">=</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span>
    <span class="n">max_t</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">stop_last_trials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The number of samples is the number of hyperparameter combinations
that will be tried out. This Tune run is set to <code class="docutils literal notranslate"><span class="pre">1000</span></code> samples.
(you can decrease this if it takes too long on your machine).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we run the experiment to <code class="docutils literal notranslate"><span class="pre">min</span></code>imize the “mean_loss” of the <code class="docutils literal notranslate"><span class="pre">objective</span></code>
by searching within <code class="docutils literal notranslate"><span class="pre">&quot;steps&quot;:</span> <span class="pre">100</span></code> via <code class="docutils literal notranslate"><span class="pre">algo</span></code>, <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> times. This previous
sentence is fully characterizes the search problem we aim to solve.
With this in mind, notice how efficient it is to execute <code class="docutils literal notranslate"><span class="pre">tuner.fit()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="p">(</span>
    <span class="n">objective</span><span class="p">,</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span>
        <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;mean_loss&quot;</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
        <span class="n">search_alg</span><span class="o">=</span><span class="n">algo</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">air</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bohb_exp&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
    <span class="p">),</span>
    <span class="n">param_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function checkpointing is disabled. This may result in unexpected behavior when using checkpointing features or certain schedulers. To enable, set the train function arguments to be `func(config, checkpoint_dir=None)`.
</pre></div>
</div>
<div class="output text_html">== Status ==<br>Current time: 2022-07-22 15:07:54 (running for 00:00:26.41)<br>Memory usage on this node: 9.9/16.0 GiB<br>Using HyperBand: num_stopped=9 total_brackets=1
Round #0:
  Bracket(Max Size (n)=1, Milestone (r)=64, completed=66.8%): {TERMINATED: 10} <br>Resources requested: 0/16 CPUs, 0/0 GPUs, 0.0/4.95 GiB heap, 0.0/2.0 GiB objects<br>Current best trial: a0c11456 with mean_loss=-4.53376204004117 and parameters={'steps': 100, 'width': 3.7250202606878258, 'height': -57.97769618290691, 'activation': 'tanh'}<br>Result logdir: /Users/kai/ray_results/bohb_exp<br>Number of trials: 10/10 (10 TERMINATED)<br><table>
<thead>
<tr><th>Trial name        </th><th>status    </th><th>loc            </th><th>activation  </th><th style="text-align: right;">   height</th><th style="text-align: right;">   width</th><th style="text-align: right;">    loss</th><th style="text-align: right;">  iter</th><th style="text-align: right;">  total time (s)</th><th style="text-align: right;">  ts</th><th style="text-align: right;">  iterations</th><th style="text-align: right;">  neg_mean_loss</th></tr>
</thead>
<tbody>
<tr><td>objective_9e8d8b06</td><td>TERMINATED</td><td>127.0.0.1:45117</td><td>tanh        </td><td style="text-align: right;"> 37.6516 </td><td style="text-align: right;">12.2188 </td><td style="text-align: right;"> 5.28254</td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.23943 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -5.28254</td></tr>
<tr><td>objective_a052a214</td><td>TERMINATED</td><td>127.0.0.1:45150</td><td>relu        </td><td style="text-align: right;"> -4.10627</td><td style="text-align: right;">17.9931 </td><td style="text-align: right;">11.1524 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.531915</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -11.1524 </td></tr>
<tr><td>objective_a06180d6</td><td>TERMINATED</td><td>127.0.0.1:45151</td><td>tanh        </td><td style="text-align: right;"> 89.5711 </td><td style="text-align: right;"> 8.05512</td><td style="text-align: right;">12.884  </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.534212</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -12.884  </td></tr>
<tr><td>objective_a077899e</td><td>TERMINATED</td><td>127.0.0.1:45152</td><td>relu        </td><td style="text-align: right;"> 67.3538 </td><td style="text-align: right;">13.6388 </td><td style="text-align: right;">18.6994 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.538702</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -18.6994 </td></tr>
<tr><td>objective_a0865c76</td><td>TERMINATED</td><td>127.0.0.1:45153</td><td>relu        </td><td style="text-align: right;"> 25.9876 </td><td style="text-align: right;"> 9.57103</td><td style="text-align: right;">15.1819 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.559531</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -15.1819 </td></tr>
<tr><td>objective_a0a42d1e</td><td>TERMINATED</td><td>127.0.0.1:45154</td><td>relu        </td><td style="text-align: right;"> 80.9133 </td><td style="text-align: right;">13.0972 </td><td style="text-align: right;">20.1201 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.538588</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -20.1201 </td></tr>
<tr><td>objective_a0c11456</td><td>TERMINATED</td><td>127.0.0.1:45117</td><td>tanh        </td><td style="text-align: right;">-57.9777 </td><td style="text-align: right;"> 3.72502</td><td style="text-align: right;">-4.53376</td><td style="text-align: right;">   100</td><td style="text-align: right;">       13.0563  </td><td style="text-align: right;">   0</td><td style="text-align: right;">          99</td><td style="text-align: right;">        4.53376</td></tr>
<tr><td>objective_a0dce442</td><td>TERMINATED</td><td>127.0.0.1:45200</td><td>tanh        </td><td style="text-align: right;"> -1.68715</td><td style="text-align: right;"> 1.87185</td><td style="text-align: right;"> 3.4575 </td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.27704 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -3.4575 </td></tr>
<tr><td>objective_a0f84156</td><td>TERMINATED</td><td>127.0.0.1:45157</td><td>tanh        </td><td style="text-align: right;"> 65.9879 </td><td style="text-align: right;"> 5.41575</td><td style="text-align: right;">11.4087 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.548028</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -11.4087 </td></tr>
<tr><td>objective_a1142416</td><td>TERMINATED</td><td>127.0.0.1:45201</td><td>tanh        </td><td style="text-align: right;">  5.35569</td><td style="text-align: right;"> 4.85644</td><td style="text-align: right;"> 2.74262</td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.27749 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -2.74262</td></tr>
</tbody>
</table><br><br></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_9e8d8b06:
  date: 2022-07-22_15-07-31
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.765164520733162
  neg_mean_loss: -14.765164520733162
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10084700584411621
  time_this_iter_s: 0.10084700584411621
  time_total_s: 0.10084700584411621
  timestamp: 1658498851
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 9e8d8b06
  warmup_time: 0.005752086639404297
  
Result for objective_a06180d6:
  date: 2022-07-22_15-07-31
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 19.957107852020386
  neg_mean_loss: -19.957107852020386
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10333395004272461
  time_this_iter_s: 0.10333395004272461
  time_total_s: 0.10333395004272461
  timestamp: 1658498851
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a06180d6
  warmup_time: 0.005752086639404297
  
Result for objective_a0a42d1e:
  date: 2022-07-22_15-07-31
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 28.091327935768636
  neg_mean_loss: -28.091327935768636
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10419368743896484
  time_this_iter_s: 0.10419368743896484
  time_total_s: 0.10419368743896484
  timestamp: 1658498851
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a0a42d1e
  warmup_time: 0.005752086639404297
  
Result for objective_a0c11456:
  date: 2022-07-22_15-07-31
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 5.202230381709309
  neg_mean_loss: -5.202230381709309
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10060286521911621
  time_this_iter_s: 0.10060286521911621
  time_total_s: 0.10060286521911621
  timestamp: 1658498851
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a0c11456
  warmup_time: 0.005752086639404297
  
Result for objective_a0dce442:
  date: 2022-07-22_15-07-32
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 10.831285273000042
  neg_mean_loss: -10.831285273000042
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10183191299438477
  time_this_iter_s: 0.10183191299438477
  time_total_s: 0.10183191299438477
  timestamp: 1658498852
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a0dce442
  warmup_time: 0.005752086639404297
  
Result for objective_a0f84156:
  date: 2022-07-22_15-07-32
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 17.598785421495204
  neg_mean_loss: -17.598785421495204
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10328507423400879
  time_this_iter_s: 0.10328507423400879
  time_total_s: 0.10328507423400879
  timestamp: 1658498852
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a0f84156
  warmup_time: 0.005752086639404297
  
Result for objective_a1142416:
  date: 2022-07-22_15-07-32
  done: false
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 11.53556906389516
  neg_mean_loss: -11.53556906389516
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10475611686706543
  time_this_iter_s: 0.10475611686706543
  time_total_s: 0.10475611686706543
  timestamp: 1658498852
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a1142416
  warmup_time: 0.005752086639404297
  
Result for objective_a052a214:
  date: 2022-07-22_15-07-34
  done: false
  experiment_id: 0fb96edfd1b34561b337e7146a3c64aa
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 19.5893732640325
  neg_mean_loss: -19.5893732640325
  node_ip: 127.0.0.1
  pid: 45126
  time_since_restore: 0.10437989234924316
  time_this_iter_s: 0.10437989234924316
  time_total_s: 0.10437989234924316
  timestamp: 1658498854
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a052a214
  warmup_time: 0.003122091293334961
  
Result for objective_a077899e:
  date: 2022-07-22_15-07-34
  done: false
  experiment_id: 008f8a44fb0c4475a3e9dad32f1bd2c9
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 26.735381559909975
  neg_mean_loss: -26.735381559909975
  node_ip: 127.0.0.1
  pid: 45129
  time_since_restore: 0.10449695587158203
  time_this_iter_s: 0.10449695587158203
  time_total_s: 0.10449695587158203
  timestamp: 1658498854
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a077899e
  warmup_time: 0.0031490325927734375
  
Result for objective_a0865c76:
  date: 2022-07-22_15-07-34
  done: false
  experiment_id: 06a194a4b7784ca5932a66e44e3cd815
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 22.598763488408313
  neg_mean_loss: -22.598763488408313
  node_ip: 127.0.0.1
  pid: 45132
  time_since_restore: 0.10512685775756836
  time_this_iter_s: 0.10512685775756836
  time_total_s: 0.10512685775756836
  timestamp: 1658498854
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: a0865c76
  warmup_time: 0.00397801399230957
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:34,468	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_9e8d8b06_1_activation=tanh,height=37.6516,steps=100,width=12.2188_2022-07-22_15-07-28/checkpoint_tmpf674c6
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:34,469	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10084700584411621, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45154)</span> 2022-07-22 15:07:37,958	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0a42d1e_6_activation=relu,height=80.9133,steps=100,width=13.0972_2022-07-22_15-07-31/checkpoint_tmp30fafa
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45154)</span> 2022-07-22 15:07:37,958	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10419368743896484, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45155)</span> 2022-07-22 15:07:37,952	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0c11456_7_activation=tanh,height=-57.9777,steps=100,width=3.7250_2022-07-22_15-07-31/checkpoint_tmp7c225a
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45155)</span> 2022-07-22 15:07:37,952	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10060286521911621, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45151)</span> 2022-07-22 15:07:37,933	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a06180d6_3_activation=tanh,height=89.5711,steps=100,width=8.0551_2022-07-22_15-07-31/checkpoint_tmpcde58c
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45151)</span> 2022-07-22 15:07:37,933	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10333395004272461, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45150)</span> 2022-07-22 15:07:37,929	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a052a214_2_activation=relu,height=-4.1063,steps=100,width=17.9931_2022-07-22_15-07-31/checkpoint_tmp24072a
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45150)</span> 2022-07-22 15:07:37,929	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10437989234924316, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45153)</span> 2022-07-22 15:07:38,010	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0865c76_5_activation=relu,height=25.9876,steps=100,width=9.5710_2022-07-22_15-07-31/checkpoint_tmpad3367
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45153)</span> 2022-07-22 15:07:38,010	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10512685775756836, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45158)</span> 2022-07-22 15:07:38,010	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a1142416_10_activation=tanh,height=5.3557,steps=100,width=4.8564_2022-07-22_15-07-32/checkpoint_tmpe18b15
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45158)</span> 2022-07-22 15:07:38,010	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10475611686706543, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45156)</span> 2022-07-22 15:07:38,008	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0dce442_8_activation=tanh,height=-1.6871,steps=100,width=1.8718_2022-07-22_15-07-32/checkpoint_tmp01ad4f
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45156)</span> 2022-07-22 15:07:38,008	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10183191299438477, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45157)</span> 2022-07-22 15:07:38,025	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0f84156_9_activation=tanh,height=65.9879,steps=100,width=5.4158_2022-07-22_15-07-32/checkpoint_tmp57fedd
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45157)</span> 2022-07-22 15:07:38,025	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10328507423400879, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45152)</span> 2022-07-22 15:07:38,022	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a077899e_4_activation=relu,height=67.3538,steps=100,width=13.6388_2022-07-22_15-07-31/checkpoint_tmpfdb6b4
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45152)</span> 2022-07-22 15:07:38,022	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10449695587158203, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_a06180d6:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 19.957107852020386
  neg_mean_loss: -19.957107852020386
  node_ip: 127.0.0.1
  pid: 45151
  time_since_restore: 0.10456109046936035
  time_this_iter_s: 0.10456109046936035
  time_total_s: 0.20789504051208496
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a06180d6
  warmup_time: 0.010712862014770508
  
Result for objective_a0c11456:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 5.202230381709309
  neg_mean_loss: -5.202230381709309
  node_ip: 127.0.0.1
  pid: 45155
  time_since_restore: 0.10466408729553223
  time_this_iter_s: 0.10466408729553223
  time_total_s: 0.20526695251464844
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a0c11456
  warmup_time: 0.007361888885498047
  
Result for objective_a0a42d1e:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 28.091327935768636
  neg_mean_loss: -28.091327935768636
  node_ip: 127.0.0.1
  pid: 45154
  time_since_restore: 0.10032892227172852
  time_this_iter_s: 0.10032892227172852
  time_total_s: 0.20452260971069336
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a0a42d1e
  warmup_time: 0.008682966232299805
  
Result for objective_a0dce442:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 10.831285273000042
  neg_mean_loss: -10.831285273000042
  node_ip: 127.0.0.1
  pid: 45156
  time_since_restore: 0.10120797157287598
  time_this_iter_s: 0.10120797157287598
  time_total_s: 0.20303988456726074
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a0dce442
  warmup_time: 0.0077381134033203125
  
Result for objective_a1142416:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 11.53556906389516
  neg_mean_loss: -11.53556906389516
  node_ip: 127.0.0.1
  pid: 45158
  time_since_restore: 0.10349392890930176
  time_this_iter_s: 0.10349392890930176
  time_total_s: 0.2082500457763672
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a1142416
  warmup_time: 0.007157087326049805
  
Result for objective_a0f84156:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 17.598785421495204
  neg_mean_loss: -17.598785421495204
  node_ip: 127.0.0.1
  pid: 45157
  time_since_restore: 0.10368680953979492
  time_this_iter_s: 0.10368680953979492
  time_total_s: 0.2069718837738037
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: a0f84156
  warmup_time: 0.006359100341796875
  
Result for objective_a052a214:
  date: 2022-07-22_15-07-38
  done: false
  episodes_total: 0
  experiment_id: 0fb96edfd1b34561b337e7146a3c64aa
  experiment_tag: 2_activation=relu,height=-4.1063,steps=100,width=17.9931
  hostname: Kais-MacBook-Pro.local
  iterations: 3
  iterations_since_restore: 4
  mean_loss: 11.152378612292932
  neg_mean_loss: -11.152378612292932
  node_ip: 127.0.0.1
  pid: 45150
  time_since_restore: 0.4275352954864502
  time_this_iter_s: 0.1124732494354248
  time_total_s: 0.5319151878356934
  timestamp: 1658498858
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 4
  trial_id: a052a214
  warmup_time: 0.010692834854125977
  
Result for objective_9e8d8b06:
  date: 2022-07-22_15-07-39
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.765164520733162
  neg_mean_loss: -14.765164520733162
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 0.10145044326782227
  time_this_iter_s: 0.10145044326782227
  time_total_s: 0.6308252811431885
  timestamp: 1658498859
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 9e8d8b06
  warmup_time: 0.005752086639404297
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:39,222	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_9e8d8b06_1_activation=tanh,height=37.6516,steps=100,width=12.2188_2022-07-22_15-07-28/checkpoint_tmpacb5ff
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:39,223	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.5293748378753662, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45199)</span> 2022-07-22 15:07:41,833	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0c11456_7_activation=tanh,height=-57.9777,steps=100,width=3.7250_2022-07-22_15-07-31/checkpoint_tmpdf2071
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45199)</span> 2022-07-22 15:07:41,833	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.53450608253479, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45200)</span> 2022-07-22 15:07:41,833	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0dce442_8_activation=tanh,height=-1.6871,steps=100,width=1.8718_2022-07-22_15-07-32/checkpoint_tmp9cd0fc
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45200)</span> 2022-07-22 15:07:41,833	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.5349018573760986, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45201)</span> 2022-07-22 15:07:41,882	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a1142416_10_activation=tanh,height=5.3557,steps=100,width=4.8564_2022-07-22_15-07-32/checkpoint_tmp7bd297
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45201)</span> 2022-07-22 15:07:41,882	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.5445291996002197, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_a0c11456:
  date: 2022-07-22_15-07-43
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 11
  iterations_since_restore: 12
  mean_loss: -2.8360322412948014
  neg_mean_loss: 2.8360322412948014
  node_ip: 127.0.0.1
  pid: 45199
  time_since_restore: 1.3028512001037598
  time_this_iter_s: 0.10884499549865723
  time_total_s: 1.8373572826385498
  timestamp: 1658498863
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 12
  trial_id: a0c11456
  warmup_time: 0.0074689388275146484
  
Result for objective_a0dce442:
  date: 2022-07-22_15-07-43
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 11
  iterations_since_restore: 12
  mean_loss: 4.100295137851358
  neg_mean_loss: -4.100295137851358
  node_ip: 127.0.0.1
  pid: 45200
  time_since_restore: 1.3082969188690186
  time_this_iter_s: 0.10707712173461914
  time_total_s: 1.8431987762451172
  timestamp: 1658498863
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 12
  trial_id: a0dce442
  warmup_time: 0.007519960403442383
  
Result for objective_a1142416:
  date: 2022-07-22_15-07-43
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 11
  iterations_since_restore: 12
  mean_loss: 3.112339173810433
  neg_mean_loss: -3.112339173810433
  node_ip: 127.0.0.1
  pid: 45201
  time_since_restore: 1.2954580783843994
  time_this_iter_s: 0.1081690788269043
  time_total_s: 1.8399872779846191
  timestamp: 1658498863
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 12
  trial_id: a1142416
  warmup_time: 0.006086826324462891
  
Result for objective_a1142416:
  date: 2022-07-22_15-07-43
  done: true
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 15
  iterations_since_restore: 16
  mean_loss: 2.7426202715773025
  neg_mean_loss: -2.7426202715773025
  node_ip: 127.0.0.1
  pid: 45201
  time_since_restore: 1.7329609394073486
  time_this_iter_s: 0.1072549819946289
  time_total_s: 2.2774901390075684
  timestamp: 1658498863
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 16
  trial_id: a1142416
  warmup_time: 0.006086826324462891
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:43,765	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp/objective_a0c11456_7_activation=tanh,height=-57.9777,steps=100,width=3.7250_2022-07-22_15-07-31/checkpoint_tmp3f09eb
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45117)</span> 2022-07-22 15:07:43,765	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 2.273958206176758, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_a0c11456:
  date: 2022-07-22_15-07-48
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 40
  iterations_since_restore: 41
  mean_loss: -4.168842006342518
  neg_mean_loss: 4.168842006342518
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 4.4259912967681885
  time_this_iter_s: 0.10874629020690918
  time_total_s: 6.699949502944946
  timestamp: 1658498868
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 41
  trial_id: a0c11456
  warmup_time: 0.005752086639404297
  
Result for objective_a0c11456:
  date: 2022-07-22_15-07-53
  done: false
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 87
  iterations_since_restore: 88
  mean_loss: -4.498437215767879
  neg_mean_loss: 4.498437215767879
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 9.488422155380249
  time_this_iter_s: 0.10667800903320312
  time_total_s: 11.762380361557007
  timestamp: 1658498873
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 88
  trial_id: a0c11456
  warmup_time: 0.005752086639404297
  
Result for objective_a0c11456:
  date: 2022-07-22_15-07-54
  done: true
  episodes_total: 0
  experiment_id: c1cb9895c3f04e73b7cce9435cd92c68
  hostname: Kais-MacBook-Pro.local
  iterations: 99
  iterations_since_restore: 100
  mean_loss: -4.53376204004117
  neg_mean_loss: 4.53376204004117
  node_ip: 127.0.0.1
  pid: 45117
  time_since_restore: 10.782363176345825
  time_this_iter_s: 0.1065070629119873
  time_total_s: 13.056321382522583
  timestamp: 1658498874
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 100
  trial_id: a0c11456
  warmup_time: 0.005752086639404297
  
</pre></div>
</div>
</div>
</div>
<p>Here are the hyperparameters found to minimize the mean loss of the defined objective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best hyperparameters found were: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">()</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best hyperparameters found were:  {&#39;steps&#39;: 100, &#39;width&#39;: 3.7250202606878258, &#39;height&#39;: -57.97769618290691, &#39;activation&#39;: &#39;tanh&#39;}
</pre></div>
</div>
</div>
</div>
<section id="optional-passing-the-search-space-via-the-tunebohb-algorithm">
<h2>Optional: Passing the search space via the TuneBOHB algorithm<a class="headerlink" href="bohb_example.html#optional-passing-the-search-space-via-the-tunebohb-algorithm" title="Permalink to this headline">#</a></h2>
<p>We can define the hyperparameter search space using <code class="docutils literal notranslate"><span class="pre">ConfigSpace</span></code>,
which is the format accepted by BOHB.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config_space</span> <span class="o">=</span> <span class="n">CS</span><span class="o">.</span><span class="n">ConfigurationSpace</span><span class="p">()</span>
<span class="n">config_space</span><span class="o">.</span><span class="n">add_hyperparameter</span><span class="p">(</span>
    <span class="n">CS</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;steps&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">config_space</span><span class="o">.</span><span class="n">add_hyperparameter</span><span class="p">(</span>
    <span class="n">CS</span><span class="o">.</span><span class="n">UniformFloatHyperparameter</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">config_space</span><span class="o">.</span><span class="n">add_hyperparameter</span><span class="p">(</span>
    <span class="n">CS</span><span class="o">.</span><span class="n">UniformFloatHyperparameter</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">config_space</span><span class="o">.</span><span class="n">add_hyperparameter</span><span class="p">(</span>
    <span class="n">CS</span><span class="o">.</span><span class="n">CategoricalHyperparameter</span><span class="p">(</span>
        <span class="s2">&quot;activation&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/kai/.pyenv/versions/3.7.7/lib/python3.7/site-packages/ipykernel_launcher.py:3: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  This is separate from the ipykernel package so we can avoid doing imports until
/Users/kai/.pyenv/versions/3.7.7/lib/python3.7/site-packages/ipykernel_launcher.py:6: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  
/Users/kai/.pyenv/versions/3.7.7/lib/python3.7/site-packages/ipykernel_launcher.py:9: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if __name__ == &quot;__main__&quot;:
/Users/kai/.pyenv/versions/3.7.7/lib/python3.7/site-packages/ipykernel_launcher.py:13: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  del sys.path[0]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>activation, Type: Categorical, Choices: {relu, tanh}, Default: relu
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As we are passing config space directly to the searcher,</span>
<span class="c1"># we need to define metric and mode in it as well, in addition</span>
<span class="c1"># to Tuner()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">TuneBOHB</span><span class="p">(</span>
    <span class="n">space</span><span class="o">=</span><span class="n">config_space</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;mean_loss&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">ConcurrencyLimiter</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">max_concurrent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">HyperBandForBOHB</span><span class="p">(</span>
    <span class="n">time_attr</span><span class="o">=</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span>
    <span class="n">max_t</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">stop_last_trials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="p">(</span>
    <span class="n">objective</span><span class="p">,</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span>
        <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;mean_loss&quot;</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
        <span class="n">search_alg</span><span class="o">=</span><span class="n">algo</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">air</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bohb_exp_2&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">== Status ==<br>Current time: 2022-07-22 15:11:40 (running for 00:00:29.52)<br>Memory usage on this node: 10.3/16.0 GiB<br>Using HyperBand: num_stopped=9 total_brackets=1
Round #0:
  Bracket(Max Size (n)=1, Milestone (r)=64, completed=66.8%): {TERMINATED: 10} <br>Resources requested: 0/16 CPUs, 0/0 GPUs, 0.0/4.95 GiB heap, 0.0/2.0 GiB objects<br>Current best trial: 25b64488 with mean_loss=-3.74634537130406 and parameters={'activation': 'tanh', 'height': -48.451797714080236, 'steps': 100, 'width': 10.119125894538891}<br>Result logdir: /Users/kai/ray_results/bohb_exp_2<br>Number of trials: 10/10 (10 TERMINATED)<br><table>
<thead>
<tr><th>Trial name        </th><th>status    </th><th>loc            </th><th>activation  </th><th style="text-align: right;">  height</th><th style="text-align: right;">  steps</th><th style="text-align: right;">    width</th><th style="text-align: right;">    loss</th><th style="text-align: right;">  iter</th><th style="text-align: right;">  total time (s)</th><th style="text-align: right;">  ts</th><th style="text-align: right;">  iterations</th><th style="text-align: right;">  neg_mean_loss</th></tr>
</thead>
<tbody>
<tr><td>objective_2397442c</td><td>TERMINATED</td><td>127.0.0.1:45401</td><td>tanh        </td><td style="text-align: right;"> 32.8422</td><td style="text-align: right;">    100</td><td style="text-align: right;">12.1847  </td><td style="text-align: right;"> 4.80297</td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.25951 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -4.80297</td></tr>
<tr><td>objective_25b4a998</td><td>TERMINATED</td><td>127.0.0.1:45401</td><td>relu        </td><td style="text-align: right;"> 20.2852</td><td style="text-align: right;">    100</td><td style="text-align: right;"> 2.08202 </td><td style="text-align: right;">18.1839 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.535426</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -18.1839 </td></tr>
<tr><td>objective_25b64488</td><td>TERMINATED</td><td>127.0.0.1:45453</td><td>tanh        </td><td style="text-align: right;">-48.4518</td><td style="text-align: right;">    100</td><td style="text-align: right;">10.1191  </td><td style="text-align: right;">-3.74635</td><td style="text-align: right;">   100</td><td style="text-align: right;">       11.5319  </td><td style="text-align: right;">   0</td><td style="text-align: right;">          99</td><td style="text-align: right;">        3.74635</td></tr>
<tr><td>objective_25b7dfe6</td><td>TERMINATED</td><td>127.0.0.1:45403</td><td>relu        </td><td style="text-align: right;">-18.8439</td><td style="text-align: right;">    100</td><td style="text-align: right;">19.1277  </td><td style="text-align: right;"> 9.59966</td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.581903</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">       -9.59966</td></tr>
<tr><td>objective_25cfab4e</td><td>TERMINATED</td><td>127.0.0.1:45404</td><td>relu        </td><td style="text-align: right;"> 17.2057</td><td style="text-align: right;">    100</td><td style="text-align: right;"> 0.317083</td><td style="text-align: right;">20.8519 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.59468 </td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -20.8519 </td></tr>
<tr><td>objective_278eba4c</td><td>TERMINATED</td><td>127.0.0.1:45454</td><td>relu        </td><td style="text-align: right;">-27.0179</td><td style="text-align: right;">    100</td><td style="text-align: right;">13.577   </td><td style="text-align: right;"> 7.76626</td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.31198 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -7.76626</td></tr>
<tr><td>objective_279d01a6</td><td>TERMINATED</td><td>127.0.0.1:45407</td><td>relu        </td><td style="text-align: right;"> 59.1103</td><td style="text-align: right;">    100</td><td style="text-align: right;"> 2.4466  </td><td style="text-align: right;">21.6781 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.575556</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -21.6781 </td></tr>
<tr><td>objective_27aa31e6</td><td>TERMINATED</td><td>127.0.0.1:45409</td><td>relu        </td><td style="text-align: right;"> 50.058 </td><td style="text-align: right;">    100</td><td style="text-align: right;">17.3776  </td><td style="text-align: right;">16.6153 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.537561</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -16.6153 </td></tr>
<tr><td>objective_27b7e2be</td><td>TERMINATED</td><td>127.0.0.1:45455</td><td>relu        </td><td style="text-align: right;">-51.2093</td><td style="text-align: right;">    100</td><td style="text-align: right;"> 8.94948 </td><td style="text-align: right;"> 5.57235</td><td style="text-align: right;">    16</td><td style="text-align: right;">        2.64238 </td><td style="text-align: right;">   0</td><td style="text-align: right;">          15</td><td style="text-align: right;">       -5.57235</td></tr>
<tr><td>objective_27c59a80</td><td>TERMINATED</td><td>127.0.0.1:45446</td><td>relu        </td><td style="text-align: right;"> 29.165 </td><td style="text-align: right;">    100</td><td style="text-align: right;"> 4.26995 </td><td style="text-align: right;">17.3006 </td><td style="text-align: right;">     4</td><td style="text-align: right;">        0.539177</td><td style="text-align: right;">   0</td><td style="text-align: right;">           3</td><td style="text-align: right;">      -17.3006 </td></tr>
</tbody>
</table><br><br></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_2397442c:
  date: 2022-07-22_15-11-15
  done: false
  experiment_id: 1a4ebf62df50443492dc6df792fcb67a
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.284216630043918
  neg_mean_loss: -14.284216630043918
  node_ip: 127.0.0.1
  pid: 45353
  time_since_restore: 0.10108494758605957
  time_this_iter_s: 0.10108494758605957
  time_total_s: 0.10108494758605957
  timestamp: 1658499075
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 2397442c
  warmup_time: 0.002635955810546875
  
Result for objective_25b7dfe6:
  date: 2022-07-22_15-11-17
  done: false
  experiment_id: 0fd6607aa9674cb5a05b6ce63e474fd3
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 18.115606120430186
  neg_mean_loss: -18.115606120430186
  node_ip: 127.0.0.1
  pid: 45371
  time_since_restore: 0.10365676879882812
  time_this_iter_s: 0.10365676879882812
  time_total_s: 0.10365676879882812
  timestamp: 1658499077
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 25b7dfe6
  warmup_time: 0.005063056945800781
  
Result for objective_25b4a998:
  date: 2022-07-22_15-11-17
  done: false
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 22.028519616352035
  neg_mean_loss: -22.028519616352035
  node_ip: 127.0.0.1
  pid: 45369
  time_since_restore: 0.10431909561157227
  time_this_iter_s: 0.10431909561157227
  time_total_s: 0.10431909561157227
  timestamp: 1658499077
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 25b4a998
  warmup_time: 0.004379987716674805
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-17
  done: false
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 6.154820228591976
  neg_mean_loss: -6.154820228591976
  node_ip: 127.0.0.1
  pid: 45370
  time_since_restore: 0.10407018661499023
  time_this_iter_s: 0.10407018661499023
  time_total_s: 0.10407018661499023
  timestamp: 1658499077
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 25b64488
  warmup_time: 0.003113985061645508
  
Result for objective_25cfab4e:
  date: 2022-07-22_15-11-18
  done: false
  experiment_id: fdc43ca37ed44cde857ca150a8f1e84f
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 21.72056884033249
  neg_mean_loss: -21.72056884033249
  node_ip: 127.0.0.1
  pid: 45378
  time_since_restore: 0.10431408882141113
  time_this_iter_s: 0.10431408882141113
  time_total_s: 0.10431408882141113
  timestamp: 1658499078
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 25cfab4e
  warmup_time: 0.0029649734497070312
  
Result for objective_279d01a6:
  date: 2022-07-22_15-11-18
  done: false
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 25.911032294938884
  neg_mean_loss: -25.911032294938884
  node_ip: 127.0.0.1
  pid: 45369
  time_since_restore: 0.10361599922180176
  time_this_iter_s: 0.10361599922180176
  time_total_s: 0.10361599922180176
  timestamp: 1658499078
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 279d01a6
  warmup_time: 0.004379987716674805
  
Result for objective_27aa31e6:
  date: 2022-07-22_15-11-18
  done: false
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 25.005798678308594
  neg_mean_loss: -25.005798678308594
  node_ip: 127.0.0.1
  pid: 45370
  time_since_restore: 0.10430693626403809
  time_this_iter_s: 0.10430693626403809
  time_total_s: 0.10430693626403809
  timestamp: 1658499078
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 27aa31e6
  warmup_time: 0.003113985061645508
  
Result for objective_27b7e2be:
  date: 2022-07-22_15-11-18
  done: false
  experiment_id: fdc43ca37ed44cde857ca150a8f1e84f
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.879072389639937
  neg_mean_loss: -14.879072389639937
  node_ip: 127.0.0.1
  pid: 45378
  time_since_restore: 0.10371994972229004
  time_this_iter_s: 0.10371994972229004
  time_total_s: 0.10371994972229004
  timestamp: 1658499078
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 27b7e2be
  warmup_time: 0.0029649734497070312
  
Result for objective_27c59a80:
  date: 2022-07-22_15-11-18
  done: false
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 22.916501000037474
  neg_mean_loss: -22.916501000037474
  node_ip: 127.0.0.1
  pid: 45369
  time_since_restore: 0.10353732109069824
  time_this_iter_s: 0.10353732109069824
  time_total_s: 0.10353732109069824
  timestamp: 1658499078
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 27c59a80
  warmup_time: 0.004379987716674805
  
Result for objective_278eba4c:
  date: 2022-07-22_15-11-20
  done: false
  experiment_id: 90186993d7ff42698c4615640d47d896
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 17.29821256734647
  neg_mean_loss: -17.29821256734647
  node_ip: 127.0.0.1
  pid: 45393
  time_since_restore: 0.10304784774780273
  time_this_iter_s: 0.10304784774780273
  time_total_s: 0.10304784774780273
  timestamp: 1658499080
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 278eba4c
  warmup_time: 0.0027189254760742188
  
Result for objective_2397442c:
  date: 2022-07-22_15-11-20
  done: false
  episodes_total: 0
  experiment_id: 1a4ebf62df50443492dc6df792fcb67a
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.284216630043918
  neg_mean_loss: -14.284216630043918
  node_ip: 127.0.0.1
  pid: 45370
  time_since_restore: 0.10411787033081055
  time_this_iter_s: 0.10411787033081055
  time_total_s: 0.20520281791687012
  timestamp: 1658499080
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 2397442c
  warmup_time: 0.003113985061645508
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45370)</span> 2022-07-22 15:11:20,826	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_2397442c_1_activation=tanh,height=32.8422,steps=100,width=12.1847_2022-07-22_15-11-11/checkpoint_tmpf4b290
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45370)</span> 2022-07-22 15:11:20,826	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10108494758605957, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_25b4a998:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 22.028519616352035
  neg_mean_loss: -22.028519616352035
  node_ip: 127.0.0.1
  pid: 45401
  time_since_restore: 0.10445284843444824
  time_this_iter_s: 0.10445284843444824
  time_total_s: 0.2087719440460205
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 25b4a998
  warmup_time: 0.010488033294677734
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45405)</span> 2022-07-22 15:11:23,963	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_278eba4c_6_activation=relu,height=-27.0179,steps=100,width=13.5770_2022-07-22_15-11-18/checkpoint_tmpd366c5
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45405)</span> 2022-07-22 15:11:23,964	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10304784774780273, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45401)</span> 2022-07-22 15:11:23,959	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_25b4a998_2_activation=relu,height=20.2852,steps=100,width=2.0820_2022-07-22_15-11-14/checkpoint_tmpc96cdb
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45401)</span> 2022-07-22 15:11:23,959	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10431909561157227, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45402)</span> 2022-07-22 15:11:23,966	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_25b64488_3_activation=tanh,height=-48.4518,steps=100,width=10.1191_2022-07-22_15-11-14/checkpoint_tmp5ce175
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45402)</span> 2022-07-22 15:11:23,966	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10407018661499023, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45407)</span> 2022-07-22 15:11:23,966	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_279d01a6_7_activation=relu,height=59.1103,steps=100,width=2.4466_2022-07-22_15-11-18/checkpoint_tmp942eac
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45407)</span> 2022-07-22 15:11:23,966	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10361599922180176, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45404)</span> 2022-07-22 15:11:23,960	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_25cfab4e_5_activation=relu,height=17.2057,steps=100,width=0.3171_2022-07-22_15-11-15/checkpoint_tmpc8ceee
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45404)</span> 2022-07-22 15:11:23,960	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10431408882141113, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45403)</span> 2022-07-22 15:11:23,966	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_25b7dfe6_4_activation=relu,height=-18.8439,steps=100,width=19.1277_2022-07-22_15-11-14/checkpoint_tmp24108b
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45403)</span> 2022-07-22 15:11:23,966	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10365676879882812, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45409)</span> 2022-07-22 15:11:23,997	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_27aa31e6_8_activation=relu,height=50.0580,steps=100,width=17.3776_2022-07-22_15-11-18/checkpoint_tmp4218e5
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45409)</span> 2022-07-22 15:11:23,997	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10430693626403809, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_27aa31e6:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 25.005798678308594
  neg_mean_loss: -25.005798678308594
  node_ip: 127.0.0.1
  pid: 45409
  time_since_restore: 0.10203695297241211
  time_this_iter_s: 0.10203695297241211
  time_total_s: 0.2063438892364502
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 27aa31e6
  warmup_time: 0.0062160491943359375
  
Result for objective_279d01a6:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 25.911032294938884
  neg_mean_loss: -25.911032294938884
  node_ip: 127.0.0.1
  pid: 45407
  time_since_restore: 0.10443115234375
  time_this_iter_s: 0.10443115234375
  time_total_s: 0.20804715156555176
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 279d01a6
  warmup_time: 0.010073184967041016
  
Result for objective_25b7dfe6:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: 0fd6607aa9674cb5a05b6ce63e474fd3
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 18.115606120430186
  neg_mean_loss: -18.115606120430186
  node_ip: 127.0.0.1
  pid: 45403
  time_since_restore: 0.1044917106628418
  time_this_iter_s: 0.1044917106628418
  time_total_s: 0.20814847946166992
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 25b7dfe6
  warmup_time: 0.011971235275268555
  
Result for objective_25cfab4e:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: fdc43ca37ed44cde857ca150a8f1e84f
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 21.72056884033249
  neg_mean_loss: -21.72056884033249
  node_ip: 127.0.0.1
  pid: 45404
  time_since_restore: 0.10379600524902344
  time_this_iter_s: 0.10379600524902344
  time_total_s: 0.20811009407043457
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 25cfab4e
  warmup_time: 0.009023904800415039
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 6.154820228591976
  neg_mean_loss: -6.154820228591976
  node_ip: 127.0.0.1
  pid: 45402
  time_since_restore: 0.10440897941589355
  time_this_iter_s: 0.10440897941589355
  time_total_s: 0.2084791660308838
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 25b64488
  warmup_time: 0.011686325073242188
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45424)</span> 2022-07-22 15:11:24,383	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_27b7e2be_9_activation=relu,height=-51.2093,steps=100,width=8.9495_2022-07-22_15-11-18/checkpoint_tmp996dec
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45424)</span> 2022-07-22 15:11:24,384	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10371994972229004, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_27b7e2be:
  date: 2022-07-22_15-11-24
  done: false
  episodes_total: 0
  experiment_id: fdc43ca37ed44cde857ca150a8f1e84f
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.879072389639937
  neg_mean_loss: -14.879072389639937
  node_ip: 127.0.0.1
  pid: 45424
  time_since_restore: 0.1031639575958252
  time_this_iter_s: 0.1031639575958252
  time_total_s: 0.20688390731811523
  timestamp: 1658499084
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 27b7e2be
  warmup_time: 0.0069200992584228516
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45446)</span> 2022-07-22 15:11:26,749	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_27c59a80_10_activation=relu,height=29.1650,steps=100,width=4.2700_2022-07-22_15-11-18/checkpoint_tmp49d063
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45446)</span> 2022-07-22 15:11:26,749	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.10353732109069824, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_27c59a80:
  date: 2022-07-22_15-11-26
  done: false
  episodes_total: 0
  experiment_id: 20a5d76dc18749e4b1c9f15c5d8b43cf
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 22.916501000037474
  neg_mean_loss: -22.916501000037474
  node_ip: 127.0.0.1
  pid: 45446
  time_since_restore: 0.10502910614013672
  time_this_iter_s: 0.10502910614013672
  time_total_s: 0.20856642723083496
  timestamp: 1658499086
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 27c59a80
  warmup_time: 0.007359027862548828
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45401)</span> 2022-07-22 15:11:27,287	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_2397442c_1_activation=tanh,height=32.8422,steps=100,width=12.1847_2022-07-22_15-11-11/checkpoint_tmp2e0d09
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45401)</span> 2022-07-22 15:11:27,287	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.535153865814209, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_2397442c:
  date: 2022-07-22_15-11-27
  done: false
  episodes_total: 0
  experiment_id: 1a4ebf62df50443492dc6df792fcb67a
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.284216630043918
  neg_mean_loss: -14.284216630043918
  node_ip: 127.0.0.1
  pid: 45401
  time_since_restore: 0.1044008731842041
  time_this_iter_s: 0.1044008731842041
  time_total_s: 0.6395547389984131
  timestamp: 1658499087
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 2397442c
  warmup_time: 0.010488033294677734
  
Result for objective_278eba4c:
  date: 2022-07-22_15-11-29
  done: false
  episodes_total: 0
  experiment_id: 90186993d7ff42698c4615640d47d896
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 17.29821256734647
  neg_mean_loss: -17.29821256734647
  node_ip: 127.0.0.1
  pid: 45454
  time_since_restore: 0.1037449836730957
  time_this_iter_s: 0.1037449836730957
  time_total_s: 0.6844677925109863
  timestamp: 1658499089
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 278eba4c
  warmup_time: 0.006754875183105469
  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45454)</span> 2022-07-22 15:11:29,879	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_278eba4c_6_activation=relu,height=-27.0179,steps=100,width=13.5770_2022-07-22_15-11-18/checkpoint_tmp2835d4
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45454)</span> 2022-07-22 15:11:29,879	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.5807228088378906, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45455)</span> 2022-07-22 15:11:29,909	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_27b7e2be_9_activation=relu,height=-51.2093,steps=100,width=8.9495_2022-07-22_15-11-18/checkpoint_tmpd7ea63
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45455)</span> 2022-07-22 15:11:29,910	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.9150340557098389, &#39;_episodes_total&#39;: 0}
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45453)</span> 2022-07-22 15:11:29,930	INFO trainable.py:655 -- Restored on 127.0.0.1 from checkpoint: /Users/kai/ray_results/bohb_exp_2/objective_25b64488_3_activation=tanh,height=-48.4518,steps=100,width=10.1191_2022-07-22_15-11-14/checkpoint_tmp11824e
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(objective pid=45453)</span> 2022-07-22 15:11:29,930	INFO trainable.py:663 -- Current state after restoring: {&#39;_iteration&#39;: 0, &#39;_timesteps_total&#39;: 0, &#39;_time_total&#39;: 0.5960800647735596, &#39;_episodes_total&#39;: 0}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for objective_27b7e2be:
  date: 2022-07-22_15-11-30
  done: false
  episodes_total: 0
  experiment_id: fdc43ca37ed44cde857ca150a8f1e84f
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 14.879072389639937
  neg_mean_loss: -14.879072389639937
  node_ip: 127.0.0.1
  pid: 45455
  time_since_restore: 0.10332393646240234
  time_this_iter_s: 0.10332393646240234
  time_total_s: 1.0183579921722412
  timestamp: 1658499090
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 27b7e2be
  warmup_time: 0.006285190582275391
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-30
  done: false
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 0
  iterations_since_restore: 1
  mean_loss: 6.154820228591976
  neg_mean_loss: -6.154820228591976
  node_ip: 127.0.0.1
  pid: 45453
  time_since_restore: 0.1026160717010498
  time_this_iter_s: 0.1026160717010498
  time_total_s: 0.6986961364746094
  timestamp: 1658499090
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 1
  trial_id: 25b64488
  warmup_time: 0.006460905075073242
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-35
  done: false
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 46
  iterations_since_restore: 47
  mean_loss: -3.634865890857194
  neg_mean_loss: 3.634865890857194
  node_ip: 127.0.0.1
  pid: 45453
  time_since_restore: 5.1935131549835205
  time_this_iter_s: 0.10786604881286621
  time_total_s: 5.78959321975708
  timestamp: 1658499095
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 47
  trial_id: 25b64488
  warmup_time: 0.006460905075073242
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-40
  done: false
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 93
  iterations_since_restore: 94
  mean_loss: -3.740036002402735
  neg_mean_loss: 3.740036002402735
  node_ip: 127.0.0.1
  pid: 45453
  time_since_restore: 10.256795167922974
  time_this_iter_s: 0.10682511329650879
  time_total_s: 10.852875232696533
  timestamp: 1658499100
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 94
  trial_id: 25b64488
  warmup_time: 0.006460905075073242
  
Result for objective_25b64488:
  date: 2022-07-22_15-11-40
  done: true
  episodes_total: 0
  experiment_id: 75e7c1ad20a2495cac29630df6c3c782
  hostname: Kais-MacBook-Pro.local
  iterations: 99
  iterations_since_restore: 100
  mean_loss: -3.74634537130406
  neg_mean_loss: 3.74634537130406
  node_ip: 127.0.0.1
  pid: 45453
  time_since_restore: 10.935801029205322
  time_this_iter_s: 0.10489487648010254
  time_total_s: 11.531881093978882
  timestamp: 1658499100
  timesteps_since_restore: 0
  timesteps_total: 0
  training_iteration: 100
  trial_id: 25b64488
  warmup_time: 0.006460905075073242
  
</pre></div>
</div>
</div>
</div>
<p>Here again are the hyperparameters found to minimize the mean loss of the
defined objective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best hyperparameters found were: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">()</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best hyperparameters found were:  {&#39;activation&#39;: &#39;tanh&#39;, &#39;height&#39;: -48.451797714080236, &#39;steps&#39;: 100, &#39;width&#39;: 10.119125894538891}
</pre></div>
</div>
</div>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="flaml_example.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Running Tune experiments with BlendSearch and CFO</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="nevergrad_example.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Running Tune experiments with Nevergrad</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2023, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf"></script>


  </body>
</html>