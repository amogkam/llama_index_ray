
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Getting Data in and out of Tune &#8212; Ray 3.0.0.dev0</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css@digest=5115cc725059bd94278eecd172e13a965bf8f5a9.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_/static/css/badge_only.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/versionwarning.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../../_static/js/docsearch.js"></script>
    <script src="../../_static/js/rate-the-docs.es.min.js"></script>
    <script defer="defer" src="../../_static/js/termynal.js"></script>
    <script defer="defer" src="../../_static/js/custom.js"></script>
    <script defer="defer" src="../../_static/js/top-navigation.js"></script>
    <script src="../../_static/js/tags.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js@digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="../../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/tune/tutorials/tune_get_data_in_and_out.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Analyzing Tune Experiment Results" href="../examples/tune_analyze_results.html" />
    <link rel="prev" title="A Guide To Callbacks &amp; Metrics in Tune" href="tune-metrics.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  
<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": true, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "tune/tutorials/tune_get_data_in_and_out", "programming_language": "py", "project": "ray", "proxied_api_host": "/_", "source_suffix": ".md", "subprojects": {}, "theme": "sphinx_book_theme", "user_analytics_code": "", "version": "master"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 3.0.0.dev0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Welcome to Ray!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/index.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-more-libs/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/use-cases.html">
   Use Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/examples.html">
   Example Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/ray-libraries.html">
   Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-core/walkthrough.html">
   Ray Core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-air/getting-started.html">
   Ray AI Runtime (AIR)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/data.html">
   Ray Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../train/train.html">
   Ray Train
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../tune.html">
   Ray Tune
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../getting-started.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../key-concepts.html">
     Key Concepts
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="overview.html">
     User Guides
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="tune-run.html">
       Running Basic Experiments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-output.html">
       Logging and Outputs in Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-resources.html">
       Setting Trial Resources
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-search-spaces.html">
       Using Search Spaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-stopping.html">
       How to Define Stopping Criteria for a Ray Tune Experiment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-trial-checkpoints.html">
       How to Save and Load Trial Checkpoints
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-storage.html">
       How to Configure Storage Options for a Distributed Tune Experiment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-fault-tolerance.html">
       How to Enable Fault Tolerance in Ray Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-metrics.html">
       Using Callbacks and Metrics
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="tune_get_data_in_and_out.html#">
       Getting Data in and out of Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../examples/tune_analyze_results.html">
       Analyzing Tune Experiment Results
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../examples/pbt_guide.html">
       A Guide to Population Based Training with Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-distributed.html">
       Deploying Tune in the Cloud
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-lifecycle.html">
       Tune Architecture
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tune-scalability.html">
       Scalability Benchmarks
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/index.html">
     Ray Tune Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faq.html">
     Ray Tune FAQ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/api.html">
     Ray Tune API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../serve/index.html">
   Ray Serve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rllib/index.html">
   Ray RLlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-more-libs/index.html">
   More Libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-core/cluster/index.html">
   Ray Clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-observability/index.html">
   Monitoring and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-references/api.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-contribute/stability.html">
   Developer Guides
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Ftune/tutorials/tune_get_data_in_and_out.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/tune/tutorials/tune_get_data_in_and_out.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/tune/tutorials/tune_get_data_in_and_out.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-into-tune">
   Getting data into Tune
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#passing-data-into-a-tune-run-through-search-spaces">
     Passing data into a Tune run through search spaces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#using-tune-with-parameters-access-data-in-tune-runs">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       tune.with_parameters
      </span>
     </code>
     access data in Tune runs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#loading-data-in-a-tune-trainable">
     Loading data in a Tune Trainable
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-out-of-ray-tune">
   Getting data out of Ray Tune
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#reporting-metrics-with-tune">
     Reporting metrics with Tune
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#logging-metrics-with-tune-callbacks">
     Logging metrics with Tune callbacks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-out-of-tune-using-checkpoints-other-artifacts">
     Getting data out of Tune using checkpoints &amp; other artifacts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#how-do-i-access-tune-results-after-i-am-finished">
     How do I access Tune results after I am finished?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Getting Data in and out of Tune</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-into-tune">
   Getting data into Tune
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#passing-data-into-a-tune-run-through-search-spaces">
     Passing data into a Tune run through search spaces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#using-tune-with-parameters-access-data-in-tune-runs">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       tune.with_parameters
      </span>
     </code>
     access data in Tune runs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#loading-data-in-a-tune-trainable">
     Loading data in a Tune Trainable
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-out-of-ray-tune">
   Getting data out of Ray Tune
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#reporting-metrics-with-tune">
     Reporting metrics with Tune
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#logging-metrics-with-tune-callbacks">
     Logging metrics with Tune callbacks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#getting-data-out-of-tune-using-checkpoints-other-artifacts">
     Getting data out of Tune using checkpoints &amp; other artifacts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="tune_get_data_in_and_out.html#how-do-i-access-tune-results-after-i-am-finished">
     How do I access Tune results after I am finished?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="getting-data-in-and-out-of-tune">
<h1>Getting Data in and out of Tune<a class="headerlink" href="tune_get_data_in_and_out.html#getting-data-in-and-out-of-tune" title="Permalink to this headline">#</a></h1>
<p>Often, you will find yourself needing to pass data into Tune <a class="reference internal" href="../key-concepts.html#tune-60-seconds-trainables"><span class="std std-ref">Trainables</span></a> (datasets, models, other large parameters) and get data out of them (metrics, checkpoints, other artifacts). In this guide, we’ll explore different ways of doing that and see in what circumstances they should be used.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#getting-data-into-tune" id="id1">Getting data into Tune</a></p>
<ul>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#passing-data-into-a-tune-run-through-search-spaces" id="id2">Passing data into a Tune run through search spaces</a></p></li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#using-tune-with-parameters-access-data-in-tune-runs" id="id3">Using <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code> access data in Tune runs</a></p></li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#loading-data-in-a-tune-trainable" id="id4">Loading data in a Tune Trainable</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#getting-data-out-of-ray-tune" id="id5">Getting data out of Ray Tune</a></p>
<ul>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#reporting-metrics-with-tune" id="id6">Reporting metrics with Tune</a></p></li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#logging-metrics-with-tune-callbacks" id="id7">Logging metrics with Tune callbacks</a></p></li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#getting-data-out-of-tune-using-checkpoints-other-artifacts" id="id8">Getting data out of Tune using checkpoints &amp; other artifacts</a></p></li>
<li><p><a class="reference internal" href="tune_get_data_in_and_out.html#how-do-i-access-tune-results-after-i-am-finished" id="id9">How do I access Tune results after I am finished?</a></p></li>
</ul>
</li>
</ul>
</div>
<p>Let’s start by defining a simple Trainable function. We’ll be expanding this function with different functionality as we go.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="c1"># For now, we have nothing here.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>
</pre></div>
</div>
<p>Our <code class="docutils literal notranslate"><span class="pre">training_function</span></code> function requires a pandas DataFrame, a model with some hyperparameters and the number of epochs to train the model for as inputs. The hyperparameters of the model impact the metric returned, and in each epoch (iteration of training), the <code class="docutils literal notranslate"><span class="pre">trained_model</span></code> state is changed.</p>
<p>We will run hyperparameter optimization using the <a class="reference internal" href="../api/execution.html#tune-run-ref"><span class="std std-ref">Tuner API</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.tune</span> <span class="kn">import</span> <span class="n">Tuner</span>
<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>

<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span><span class="n">training_function</span><span class="p">,</span> <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<section id="getting-data-into-tune">
<h2>Getting data into Tune<a class="headerlink" href="tune_get_data_in_and_out.html#getting-data-into-tune" title="Permalink to this headline">#</a></h2>
<p>First order of business is to provide the inputs for the Trainable. We can broadly separate them into two categories - variables and constants.</p>
<p>Variables are the parameters we want to tune. They will be different for every <a class="reference internal" href="../key-concepts.html#tune-60-seconds-trials"><span class="std std-ref">Trial</span></a>. For example, those may be the learning rate and batch size for a neural network, number of trees and the maximum depth for a random forest, or the data partition if you are using Tune as an execution engine for batch training.</p>
<p>Constants are the parameters that are the same for every Trial. Those can be the number of epochs, model hyperparameters we want to set but not tune, the dataset and so on. Often, the constants will be quite large (e.g. the dataset or the model).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Objects from the outer scope of the <code class="docutils literal notranslate"><span class="pre">training_function</span></code> will also be automatically serialized and sent to Trial Actors, which may lead to unintended behavior. Examples include global locks not working (as each Actor operates on a copy) or general errors related to serialization. Best practice is to not refer to any objects from outer scope in the <code class="docutils literal notranslate"><span class="pre">training_function</span></code>.</p>
</div>
<section id="passing-data-into-a-tune-run-through-search-spaces">
<h3>Passing data into a Tune run through search spaces<a class="headerlink" href="tune_get_data_in_and_out.html#passing-data-into-a-tune-run-through-search-spaces" title="Permalink to this headline">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>TL;DR - use the <code class="docutils literal notranslate"><span class="pre">param_space</span></code> argument to specify small, serializable constants and variables.</p>
</div>
<p>The first way of passing inputs into Trainables is the <a class="reference internal" href="../key-concepts.html#tune-key-concepts-search-spaces"><span class="std std-ref"><em>search space</em></span></a> (it may also be called <em>parameter space</em> or <em>config</em>). In the Trainable itself, it maps to the <code class="docutils literal notranslate"><span class="pre">config</span></code> dict passed in as an argument to the function. You define the search space using the <code class="docutils literal notranslate"><span class="pre">param_space</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>. The search space is a dict and may be composed of <a class="reference internal" href="../api/search_space.html#tune-search-space"><span class="std std-ref"><em>distributions</em></span></a>, which will sample a different value for each Trial, or of constant values. The search space may be composed of nested dictionaries, and those in turn can have distributions as well.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Each value in the search space will be saved directly in the Trial metadata. This means that every value in the search space <strong>must</strong> be serializable and take up a small amount of memory.</p>
</div>
<p>For example, passing in a large pandas DataFrame or an unserializable model object as a value in the search space will lead to unwanted behavior. At best it will cause large slowdowns and disk space usage as Trial metadata saved to disk will also contain this data. At worst, an exception will be raised, as the data cannot be sent over to the Trial workers. For more details, see <a class="reference internal" href="../faq.html#tune-bottlenecks"><span class="std std-ref">How can I avoid bottlenecks?</span></a>.</p>
<p>Instead, use strings or other identifiers as your values, and initialize/load the objects inside your Trainable directly depending on those.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../../data/getting-started.html#data-getting-started"><span class="std std-ref">Datasets</span></a> can be used as values in the search space directly.</p>
</div>
<p>In our example, we want to tune the two model hyperparameters. We also want to set the number of epochs, so that we can easily tweak it later. For the hyperparameters, we will use the <code class="docutils literal notranslate"><span class="pre">tune.uniform</span></code> distribution. We will also modify the <code class="docutils literal notranslate"><span class="pre">training_function</span></code> to obtain those values from the <code class="docutils literal notranslate"><span class="pre">config</span></code> dictionary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="c1"># For now, we have nothing here.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>


<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">training_function</span><span class="p">,</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-tune-with-parameters-access-data-in-tune-runs">
<h3>Using <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code> access data in Tune runs<a class="headerlink" href="tune_get_data_in_and_out.html#using-tune-with-parameters-access-data-in-tune-runs" title="Permalink to this headline">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>TL;DR - use the <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code> util function to specify large constant parameters.</p>
</div>
<p>If we have large objects that are constant across Trials, we can use the <a class="reference internal" href="../api/doc/ray.tune.with_parameters.html#ray.tune.with_parameters" title="ray.tune.with_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">tune.with_parameters</span></code></a> utility to pass them into the Trainable directly. The objects will be stored in the <a class="reference internal" href="../../ray-core/objects/serialization.html#serialization-guide"><span class="std std-ref">Ray object store</span></a> so that each Trial worker may access them to obtain a local copy to use in its process.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Objects put into the Ray object store must be serializable.</p>
</div>
<p>Note that the serialization (once) and deserialization (for each Trial) of large objects may incur a performance overhead.</p>
<p>In our example, we will pass the <code class="docutils literal notranslate"><span class="pre">data</span></code> DataFrame using <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code>. In order to do that, we need to modify our function signature to include <code class="docutils literal notranslate"><span class="pre">data</span></code> as an argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>


<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">training_function</span><span class="p">,</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Next step is to wrap the <code class="docutils literal notranslate"><span class="pre">training_function</span></code> using <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code> before passing it into the <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>. Every keyword argument of the <code class="docutils literal notranslate"><span class="pre">tune.with_parameters</span></code> call will be mapped to the keyword arguments in the Trainable signature.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>

<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">tune</span><span class="o">.</span><span class="n">with_parameters</span><span class="p">(</span><span class="n">training_function</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">),</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading-data-in-a-tune-trainable">
<h3>Loading data in a Tune Trainable<a class="headerlink" href="tune_get_data_in_and_out.html#loading-data-in-a-tune-trainable" title="Permalink to this headline">#</a></h3>
<p>You can also load data directly in Trainable from e.g. cloud storage, shared file storage such as NFS, or from the local disk of the Trainable worker.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When loading from disk, ensure that all nodes in your cluster have access to the file you are trying to load.</p>
</div>
<p>A common use-case is to load the dataset from S3 or any other cloud storage with pandas, arrow or any other framework.</p>
<p>The working directory of the Trainable worker will be automatically changed to the corresponding Trial directory. For more details, see <a class="reference internal" href="../faq.html#tune-working-dir"><span class="std std-ref">How do I access relative filepaths in my Tune training function?</span></a>.</p>
<p>Our tuning run can now be run, though we will not yet obtain any meaningful outputs back.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="getting-data-out-of-ray-tune">
<h2>Getting data out of Ray Tune<a class="headerlink" href="tune_get_data_in_and_out.html#getting-data-out-of-ray-tune" title="Permalink to this headline">#</a></h2>
<p>We can now run our tuning run using the <code class="docutils literal notranslate"><span class="pre">training_function</span></code> Trainable. The next step is to report <em>metrics</em> to Tune that can be used to guide the optimization. We will also want to <em>checkpoint</em> our trained models so that we can resume the training after an interruption, and to use them for prediction later.</p>
<p>The <a class="reference internal" href="../../ray-air/api/session.html#air-session-ref"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">ray.air.session</span></code></span></a> API is used to get data out of the Trainable workers. <code class="docutils literal notranslate"><span class="pre">session.report</span></code> can be called multiple times in the Trainable function. Each call corresponds to one iteration (epoch, step, tree) of training.</p>
<section id="reporting-metrics-with-tune">
<h3>Reporting metrics with Tune<a class="headerlink" href="tune_get_data_in_and_out.html#reporting-metrics-with-tune" title="Permalink to this headline">#</a></h3>
<p><em>Metrics</em> are values passed through the <code class="docutils literal notranslate"><span class="pre">metrics</span></code> argument in a <code class="docutils literal notranslate"><span class="pre">session.report</span></code> call. Metrics can be used by Tune <a class="reference internal" href="../key-concepts.html#search-alg-ref"><span class="std std-ref">Search Algorithms</span></a> and <a class="reference internal" href="../key-concepts.html#schedulers-ref"><span class="std std-ref">Schedulers</span></a> to direct the search. After the tuning run is complete, you can <a class="reference internal" href="../examples/tune_analyze_results.html"><span class="doc std std-doc">analyze the results</span></a>, which include the reported metrics.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Similarly to search space values, each value reported as a metric will be saved directly in the Trial metadata. This means that every value reported as a metric <strong>must</strong> be serializable and take up a small amount of memory.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tune will automatically include some metrics, such as the training iteration, timestamp and more. See <a class="reference internal" href="tune-metrics.html#tune-autofilled-metrics"><span class="std std-ref">here</span></a> for the entire list.</p>
</div>
<p>In our example, we want to maximize the <code class="docutils literal notranslate"><span class="pre">metric</span></code>. We will report it each epoch to Tune, and set the <code class="docutils literal notranslate"><span class="pre">metric</span></code> and <code class="docutils literal notranslate"><span class="pre">mode</span></code> arguments in <code class="docutils literal notranslate"><span class="pre">tune.TuneConfig</span></code> to let Tune know that it should use it as the optimization objective.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.air</span> <span class="kn">import</span> <span class="n">session</span>


<span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>
        <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">})</span>


<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">tune</span><span class="o">.</span><span class="n">with_parameters</span><span class="p">(</span><span class="n">training_function</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">),</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="logging-metrics-with-tune-callbacks">
<h3>Logging metrics with Tune callbacks<a class="headerlink" href="tune_get_data_in_and_out.html#logging-metrics-with-tune-callbacks" title="Permalink to this headline">#</a></h3>
<p>Every metric logged using <code class="docutils literal notranslate"><span class="pre">session.report</span></code> can be accessed during the tuning run through Tune <a class="reference internal" href="tune-output.html#tune-logging"><span class="std std-ref">Callbacks</span></a>. Ray AIR provides <a class="reference internal" href="../../ray-air/api/experiment-tracking.html#air-builtin-callbacks"><span class="std std-ref">several built-in integrations</span></a> with popular frameworks, such as MLFlow, Weights &amp; Biases, CometML and more. You can also use the <a class="reference internal" href="../api/callbacks.html#tune-callbacks-docs"><span class="std std-ref">Callback API</span></a> to create your own callbacks.</p>
<p>Callbacks are passed in the <code class="docutils literal notranslate"><span class="pre">callback</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>’s <code class="docutils literal notranslate"><span class="pre">RunConfig</span></code>.</p>
<p>In our example, we’ll use the MLFlow callback to track the progress of our tuning run and the changing value of the <code class="docutils literal notranslate"><span class="pre">metric</span></code> (requires <code class="docutils literal notranslate"><span class="pre">mlflow</span></code> to be installed).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.air</span> <span class="kn">import</span> <span class="n">RunConfig</span>
<span class="kn">from</span> <span class="nn">ray.air.integrations.mlflow</span> <span class="kn">import</span> <span class="n">MLflowLoggerCallback</span>


<span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>
        <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">})</span>


<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">tune</span><span class="o">.</span><span class="n">with_parameters</span><span class="p">(</span><span class="n">training_function</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">),</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">RunConfig</span><span class="p">(</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">MLflowLoggerCallback</span><span class="p">(</span><span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)]</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="getting-data-out-of-tune-using-checkpoints-other-artifacts">
<h3>Getting data out of Tune using checkpoints &amp; other artifacts<a class="headerlink" href="tune_get_data_in_and_out.html#getting-data-out-of-tune-using-checkpoints-other-artifacts" title="Permalink to this headline">#</a></h3>
<p>Aside from metrics, you may want to save the state of your trained model and any other artifacts to allow resumption from training failure and further inspection and usage. Those cannot be saved as metrics, as they are often far too large and may not be easily serializable. Finally, they should be persisted on disk or cloud storage to allow access after the Tune run is interrupted or terminated.</p>
<p>Ray AIR (which contains Ray Tune) provides a <a class="reference internal" href="../../ray-air/key-concepts.html#air-checkpoints-doc"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">Checkpoint</span></code></span></a> API for that purpose. <code class="docutils literal notranslate"><span class="pre">Checkpoint</span></code> objects can be created from various sources (dictionaries, directories, cloud storage) and used between different AIR components.</p>
<p>In Tune, <code class="docutils literal notranslate"><span class="pre">Checkpoints</span></code> are created by the user in their Trainable functions and reported using the optional <code class="docutils literal notranslate"><span class="pre">checkpoint</span></code> argument of <code class="docutils literal notranslate"><span class="pre">session.report</span></code>. <code class="docutils literal notranslate"><span class="pre">Checkpoints</span></code> can contain arbitrary data and can be freely passed around the Ray cluster. After a tuning run is over, <code class="docutils literal notranslate"><span class="pre">Checkpoints</span></code> can be <a class="reference internal" href="../examples/tune_analyze_results.html"><span class="doc std std-doc">obtained from the results</span></a>.</p>
<p>Ray Tune can be configured to <a class="reference internal" href="tune-storage.html#tune-storage-options"><span class="std std-ref">automatically sync checkpoints to cloud storage</span></a>, keep only a certain number of checkpoints to save space (with <a class="reference internal" href="../../ray-air/api/doc/ray.air.CheckpointConfig.html#ray.air.CheckpointConfig" title="ray.air.config.CheckpointConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ray.air.config.CheckpointConfig</span></code></a>) and more.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The experiment state itself is checkpointed separately. See <a class="reference internal" href="tune-trial-checkpoints.html#tune-persisted-experiment-data"><span class="std std-ref">Appendix: Types of data stored by Tune</span></a> for more details.</p>
</div>
<p>In our example, we want to be able to resume the training from the latest checkpoint, and to save the <code class="docutils literal notranslate"><span class="pre">trained_model</span></code> in a checkpoint every iteration. To accomplish this, we will use the <code class="docutils literal notranslate"><span class="pre">session</span></code> and <code class="docutils literal notranslate"><span class="pre">Checkpoint</span></code> APIs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.air</span> <span class="kn">import</span> <span class="n">Checkpoint</span>


<span class="k">def</span> <span class="nf">training_function</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>

    <span class="c1"># Load the checkpoint, if there is any.</span>
    <span class="n">loaded_checkpoint</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_checkpoint</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">loaded_checkpoint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_epoch</span> <span class="o">=</span> <span class="n">loaded_checkpoint</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s2">&quot;epoch&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">last_epoch</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Simulate training &amp; evaluation - we obtain back a &quot;metric&quot; and a &quot;trained_model&quot;.</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_epoch</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># Simulate doing something expensive.</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="p">[</span><span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">}</span>

        <span class="c1"># Create the checkpoint.</span>
        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">Checkpoint</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">trained_model</span><span class="p">})</span>
        <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">},</span> <span class="n">checkpoint</span><span class="o">=</span><span class="n">checkpoint</span><span class="p">)</span>


<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">tune</span><span class="o">.</span><span class="n">with_parameters</span><span class="p">(</span><span class="n">training_function</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">),</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;hyperparameter_a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;hyperparameter_b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">RunConfig</span><span class="p">(</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">MLflowLoggerCallback</span><span class="p">(</span><span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)]</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>With all of those changes implemented, we can now run our tuning and obtain meaningful metrics and artifacts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">results</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2022-11-30 17:40:28,839 INFO tune.py:762 -- Total run time: 15.79 seconds (15.65 seconds for the tuning loop).
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>time_this_iter_s</th>
      <th>should_checkpoint</th>
      <th>done</th>
      <th>timesteps_total</th>
      <th>episodes_total</th>
      <th>training_iteration</th>
      <th>trial_id</th>
      <th>experiment_id</th>
      <th>date</th>
      <th>...</th>
      <th>hostname</th>
      <th>node_ip</th>
      <th>time_since_restore</th>
      <th>timesteps_since_restore</th>
      <th>iterations_since_restore</th>
      <th>warmup_time</th>
      <th>config/epochs</th>
      <th>config/hyperparameter_a</th>
      <th>config/hyperparameter_b</th>
      <th>logdir</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-58.399962</td>
      <td>1.015951</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>0b239_00000</td>
      <td>acf38c19d59c4cf2ad7955807657b6ea</td>
      <td>2022-11-30_17-40-26</td>
      <td>...</td>
      <td>ip-172-31-43-110</td>
      <td>172.31.43.110</td>
      <td>10.282120</td>
      <td>0</td>
      <td>10</td>
      <td>0.003541</td>
      <td>10</td>
      <td>18.065981</td>
      <td>-98.298928</td>
      <td>/home/ubuntu/ray_results/training_function_202...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-24.461518</td>
      <td>1.030420</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>0b239_00001</td>
      <td>5ca9e03d7cca46a7852cd501bc3f7b38</td>
      <td>2022-11-30_17-40-28</td>
      <td>...</td>
      <td>ip-172-31-43-110</td>
      <td>172.31.43.110</td>
      <td>10.362581</td>
      <td>0</td>
      <td>10</td>
      <td>0.004031</td>
      <td>10</td>
      <td>1.544918</td>
      <td>-47.741455</td>
      <td>/home/ubuntu/ray_results/training_function_202...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.510299</td>
      <td>1.034228</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>0b239_00002</td>
      <td>aa38dd786c714486a8d69fa5b372df48</td>
      <td>2022-11-30_17-40-28</td>
      <td>...</td>
      <td>ip-172-31-43-110</td>
      <td>172.31.43.110</td>
      <td>10.333781</td>
      <td>0</td>
      <td>10</td>
      <td>0.005286</td>
      <td>10</td>
      <td>8.129285</td>
      <td>28.846415</td>
      <td>/home/ubuntu/ray_results/training_function_202...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-16.138780</td>
      <td>1.020072</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>0b239_00003</td>
      <td>5b401e15ab614332b631d552603a8d77</td>
      <td>2022-11-30_17-40-28</td>
      <td>...</td>
      <td>ip-172-31-43-110</td>
      <td>172.31.43.110</td>
      <td>10.242707</td>
      <td>0</td>
      <td>10</td>
      <td>0.003809</td>
      <td>10</td>
      <td>17.982020</td>
      <td>-27.867871</td>
      <td>/home/ubuntu/ray_results/training_function_202...</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 23 columns</p>
</div>
<p>Checkpoints, metrics, and the log directory for each trial can be accessed through the <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code> output of a Tune experiment. For more information on how to interact with the returned <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code>, see <a class="reference internal" href="../examples/tune_analyze_results.html"><span class="doc">Analyzing Tune Experiment Results</span></a>.</p>
</section>
<section id="how-do-i-access-tune-results-after-i-am-finished">
<h3>How do I access Tune results after I am finished?<a class="headerlink" href="tune_get_data_in_and_out.html#how-do-i-access-tune-results-after-i-am-finished" title="Permalink to this headline">#</a></h3>
<p>After you have finished running the Python session, you can still access the results and checkpoints. By default, Tune will save the experiment results to the <code class="docutils literal notranslate"><span class="pre">~/ray_results</span></code> local directory. You can configure Tune to persist results in the cloud as well. See <a class="reference internal" href="tune-storage.html#tune-storage-options"><span class="std std-ref">How to Configure Storage Options for a Distributed Tune Experiment</span></a> for more information on how to configure storage options for persisting experiment results.</p>
<p>You can restore the Tune experiment by calling <a class="reference internal" href="../api/doc/ray.tune.Tuner.restore.html#ray.tune.Tuner.restore" title="ray.tune.Tuner.restore"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tuner.restore(path_or_cloud_uri,</span> <span class="pre">trainable)</span></code></a>, where <code class="docutils literal notranslate"><span class="pre">path_or_cloud_uri</span></code> points to a location either on the filesystem or cloud where the experiment was saved to. After the <code class="docutils literal notranslate"><span class="pre">Tuner</span></code> has been restored, you can access the results and checkpoints by calling <code class="docutils literal notranslate"><span class="pre">Tuner.get_results()</span></code> to receive the <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code> object, and then proceeding as outlined in the previous section.</p>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="tune-metrics.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">A Guide To Callbacks &amp; Metrics in Tune</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../examples/tune_analyze_results.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analyzing Tune Experiment Results</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2023, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf"></script>


  </body>
</html>