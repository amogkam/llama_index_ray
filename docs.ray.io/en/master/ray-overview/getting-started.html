
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Getting Started &#8212; Ray 3.0.0.dev0</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css@digest=5115cc725059bd94278eecd172e13a965bf8f5a9.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_/static/css/badge_only.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/versionwarning.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../_static/js/docsearch.js"></script>
    <script src="../_static/js/rate-the-docs.es.min.js"></script>
    <script defer="defer" src="../_static/js/termynal.js"></script>
    <script defer="defer" src="../_static/js/custom.js"></script>
    <script defer="defer" src="../_static/js/top-navigation.js"></script>
    <script src="../_static/js/tags.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js@digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/ray-overview/getting-started.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installing Ray" href="../ray-more-libs/installation.html" />
    <link rel="prev" title="Overview" href="index.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  
<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": true, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "ray-overview/getting-started", "programming_language": "py", "project": "ray", "proxied_api_host": "/_", "source_suffix": ".md", "subprojects": {}, "theme": "sphinx_book_theme", "user_analytics_code": "", "version": "master"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 3.0.0.dev0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Ray!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="getting-started.html#">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-more-libs/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="use-cases.html">
   Use Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="examples.html">
   Example Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ray-libraries.html">
   Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-core/walkthrough.html">
   Ray Core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-air/getting-started.html">
   Ray AI Runtime (AIR)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/data.html">
   Ray Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../train/train.html">
   Ray Train
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tune.html">
   Ray Tune
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../serve/index.html">
   Ray Serve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../rllib/index.html">
   Ray RLlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-more-libs/index.html">
   More Libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-core/cluster/index.html">
   Ray Clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-observability/index.html">
   Monitoring and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-references/api.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ray-contribute/stability.html">
   Developer Guides
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Fray-overview/getting-started.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/ray-overview/getting-started.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/ray-overview/getting-started.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="getting-started.html#">
   Getting Started
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-ai-runtime-quickstart">
     Ray AI Runtime Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-libraries-quickstart">
     Ray Libraries Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-core-quickstart">
     Ray Core Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-cluster-quickstart">
     Ray Cluster Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#debugging-and-monitoring-quickstart">
     Debugging and Monitoring Quickstart
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="getting-started.html#learn-more">
   Learn More
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#blog-and-press">
     Blog and Press
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#talks-videos">
     Talks (Videos)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#slides">
     Slides
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#papers">
     Papers
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Getting Started</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="getting-started.html#">
   Getting Started
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-ai-runtime-quickstart">
     Ray AI Runtime Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-libraries-quickstart">
     Ray Libraries Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-core-quickstart">
     Ray Core Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#ray-cluster-quickstart">
     Ray Cluster Quickstart
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#debugging-and-monitoring-quickstart">
     Debugging and Monitoring Quickstart
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="getting-started.html#learn-more">
   Learn More
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#blog-and-press">
     Blog and Press
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#talks-videos">
     Talks (Videos)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#slides">
     Slides
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="getting-started.html#papers">
     Papers
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <a class="reference external image-reference" href="https://ray-docs-promo.netlify.app/overview"><img alt="" src="https://ray-docs-promo.netlify.app/assets/img/overview/top.png" /></a>
<div class="bottom-right-promo-banner docutils">
<a class="reference external image-reference" href="https://ray-docs-promo.netlify.app/overview"><img alt="" src="https://ray-docs-promo.netlify.app/assets/img/overview/square.png" /></a>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="getting-started">
<span id="gentle-intro"></span><h1>Getting Started<a class="headerlink" href="getting-started.html#getting-started" title="Permalink to this headline">#</a></h1>
<p>Use Ray to scale applications on your laptop or the cloud. Choose the right guide for your task.</p>
<ul class="simple">
<li><p>Scale end-to-end ML applications: <a class="reference external" href="getting-started.html#ray-ai-runtime-quickstart">Ray AI Runtime Quickstart</a></p></li>
<li><p>Scale single ML workloads: <a class="reference external" href="getting-started.html#ray-libraries-quickstart">Ray Libraries Quickstart</a></p></li>
<li><p>Scale general Python applications: <a class="reference external" href="getting-started.html#ray-core-quickstart">Ray Core Quickstart</a></p></li>
<li><p>Deploy to the cloud: <a class="reference external" href="getting-started.html#ray-cluster-quickstart">Ray Clusters Quickstart</a></p></li>
<li><p>Debug and monitor applications: <a class="reference external" href="getting-started.html#debugging-and-monitoring-quickstart">Debugging and Monitoring Quickstart</a></p></li>
</ul>
<section id="ray-ai-runtime-quickstart">
<h2>Ray AI Runtime Quickstart<a class="headerlink" href="getting-started.html#ray-ai-runtime-quickstart" title="Permalink to this headline">#</a></h2>
<p>Explore Ray’s full suite of libraries for end-to-end ML pipelines, with the <code class="docutils literal notranslate"><span class="pre">air</span></code> packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="s2">&quot;ray[air]&quot;</span>
</pre></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Efficiently process your data into features.<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Load data into a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray</span>

<span class="c1"># Load data.</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;s3://anonymous@air-example-data/breast_cancer.csv&quot;</span><span class="p">)</span>

<span class="c1"># Split data into train and validation.</span>
<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Create a test dataset by dropping the target column.</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">valid_dataset</span><span class="o">.</span><span class="n">drop_columns</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p class="sd-card-text">Preprocess your data with a <code class="docutils literal notranslate"><span class="pre">Preprocessor</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a preprocessor to scale some columns.</span>
<span class="kn">from</span> <span class="nn">ray.data.preprocessors</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean radius&quot;</span><span class="p">,</span> <span class="s2">&quot;mean texture&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Scale out model training.<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This example will use XGBoost to train a Machine Learning model, so, install Ray’s wrapper library <code class="docutils literal notranslate"><span class="pre">xgboost_ray</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">xgboost_ray</span>
</pre></div>
</div>
<p class="sd-card-text">Train a model with an <code class="docutils literal notranslate"><span class="pre">XGBoostTrainer</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">ScalingConfig</span>
<span class="kn">from</span> <span class="nn">ray.train.xgboost</span> <span class="kn">import</span> <span class="n">XGBoostTrainer</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">XGBoostTrainer</span><span class="p">(</span>
    <span class="n">scaling_config</span><span class="o">=</span><span class="n">ScalingConfig</span><span class="p">(</span>
        <span class="c1"># Number of workers to use for data parallelism.</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="c1"># Whether to use GPU acceleration.</span>
        <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="c1"># Make sure to leave some CPUs free for Ray Data operations.</span>
        <span class="n">_max_cpu_fraction_per_node</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">label_column</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">num_boost_round</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="c1"># XGBoost specific params</span>
        <span class="s2">&quot;objective&quot;</span><span class="p">:</span> <span class="s2">&quot;binary:logistic&quot;</span><span class="p">,</span>
        <span class="c1"># &quot;tree_method&quot;: &quot;gpu_hist&quot;,  # uncomment this to use GPUs.</span>
        <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;logloss&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">datasets</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_dataset</span><span class="p">},</span>
    <span class="n">preprocessor</span><span class="o">=</span><span class="n">preprocessor</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">best_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_result</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Tune the hyperparameters to find the best model with Ray Tune.<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Configure the parameters for tuning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>

<span class="n">param_space</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)}}</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s2">&quot;train-logloss&quot;</span>
</pre></div>
</div>
<p class="sd-card-text">Run hyperparameter tuning with Ray Tune to find the best model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.tune.tuner</span> <span class="kn">import</span> <span class="n">Tuner</span><span class="p">,</span> <span class="n">TuneConfig</span>

<span class="n">tuner</span> <span class="o">=</span> <span class="n">Tuner</span><span class="p">(</span>
    <span class="n">trainer</span><span class="p">,</span>
    <span class="n">param_space</span><span class="o">=</span><span class="n">param_space</span><span class="p">,</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">result_grid</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">best_result</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best result:&quot;</span><span class="p">,</span> <span class="n">best_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Use the trained model for Batch prediction<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Use the trained model for batch prediction with a <code class="docutils literal notranslate"><span class="pre">BatchPredictor</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.train.batch_predictor</span> <span class="kn">import</span> <span class="n">BatchPredictor</span>
<span class="kn">from</span> <span class="nn">ray.train.xgboost</span> <span class="kn">import</span> <span class="n">XGBoostPredictor</span>

<span class="c1"># You can also create a checkpoint from a trained model using</span>
<span class="c1"># `XGBoostCheckpoint.from_model`.</span>
<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">best_result</span><span class="o">.</span><span class="n">checkpoint</span>

<span class="n">batch_predictor</span> <span class="o">=</span> <span class="n">BatchPredictor</span><span class="o">.</span><span class="n">from_checkpoint</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">XGBoostPredictor</span><span class="p">)</span>

<span class="n">predicted_probabilities</span> <span class="o">=</span> <span class="n">batch_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
<span class="n">predicted_probabilities</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># {&#39;predictions&#39;: 0.9970690608024597}</span>
<span class="c1"># {&#39;predictions&#39;: 0.9943051934242249}</span>
<span class="c1"># {&#39;predictions&#39;: 0.00334902573376894}</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-air/getting-started.html#air"><span class="std std-ref">Learn more about Ray AIR</span></a></span></p>
</div>
</details></section>
<section id="ray-libraries-quickstart">
<h2>Ray Libraries Quickstart<a class="headerlink" href="getting-started.html#ray-libraries-quickstart" title="Permalink to this headline">#</a></h2>
<p>Use individual libraries for single ML workloads, without having to install the full AI Runtime package. Click on the dropdowns for your workload below.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Data: Scalable Datasets for ML<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray Data is the standard way to load and exchange data in Ray libraries and applications.
Ray Data provides basic distributed data transformations such as <code class="docutils literal notranslate"><span class="pre">map</span></code>, <code class="docutils literal notranslate"><span class="pre">filter</span></code>, and <code class="docutils literal notranslate"><span class="pre">repartition</span></code>.
They are compatible with a variety of file formats, datasources, and distributed frameworks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example install Ray Data and Dask:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[data]&quot;</span> dask
</pre></div>
</div>
</div>
<p class="sd-card-text">Get started by creating a Dataset from synthetic data using <code class="docutils literal notranslate"><span class="pre">ray.data.range()</span></code> and <code class="docutils literal notranslate"><span class="pre">ray.data.from_items()</span></code>.
A Dataset can hold either plain Python objects (schema is a Python type), or Arrow records (schema is Arrow).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray</span>

<span class="c1"># Create a Dataset of Python objects.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># -&gt; Dataset(num_blocks=200, num_rows=10000, schema=&lt;class &#39;int&#39;&gt;)</span>

<span class="n">ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># -&gt; [0, 1, 2, 3, 4]</span>

<span class="n">ds</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
<span class="c1"># &lt;class &#39;int&#39;&gt;</span>

<span class="c1"># Create a Dataset from Python objects, which are held as Arrow records.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">from_items</span><span class="p">([</span>
        <span class="p">{</span><span class="s2">&quot;sepal.length&quot;</span><span class="p">:</span> <span class="mf">5.1</span><span class="p">,</span> <span class="s2">&quot;sepal.width&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
         <span class="s2">&quot;petal.length&quot;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s2">&quot;petal.width&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="s2">&quot;Setosa&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;sepal.length&quot;</span><span class="p">:</span> <span class="mf">4.9</span><span class="p">,</span> <span class="s2">&quot;sepal.width&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
         <span class="s2">&quot;petal.length&quot;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s2">&quot;petal.width&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="s2">&quot;Setosa&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;sepal.length&quot;</span><span class="p">:</span> <span class="mf">4.7</span><span class="p">,</span> <span class="s2">&quot;sepal.width&quot;</span><span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span>
         <span class="s2">&quot;petal.length&quot;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s2">&quot;petal.width&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="s2">&quot;Setosa&quot;</span><span class="p">},</span>
     <span class="p">])</span>
<span class="c1"># Dataset(num_blocks=3, num_rows=3,</span>
<span class="c1">#         schema={sepal.length: float64, sepal.width: float64,</span>
<span class="c1">#                 petal.length: float64, petal.width: float64, variety: object})</span>

<span class="n">ds</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 5.1, &#39;sepal.width&#39;: 3.5,</span>
<span class="c1">#     &#39;petal.length&#39;: 1.4, &#39;petal.width&#39;: 0.2, &#39;variety&#39;: &#39;Setosa&#39;}</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 4.9, &#39;sepal.width&#39;: 3.0,</span>
<span class="c1">#     &#39;petal.length&#39;: 1.4, &#39;petal.width&#39;: 0.2, &#39;variety&#39;: &#39;Setosa&#39;}</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 4.7, &#39;sepal.width&#39;: 3.2,</span>
<span class="c1">#     &#39;petal.length&#39;: 1.3, &#39;petal.width&#39;: 0.2, &#39;variety&#39;: &#39;Setosa&#39;}</span>

<span class="n">ds</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
<span class="c1"># -&gt; sepal.length: double</span>
<span class="c1"># -&gt; sepal.width: double</span>
<span class="c1"># -&gt; petal.length: double</span>
<span class="c1"># -&gt; petal.width: double</span>
<span class="c1"># -&gt; variety: string</span>
</pre></div>
</div>
<p class="sd-card-text">Datasets can be created from files on local disk or remote datasources such as S3. Any filesystem
<a class="reference external" href="http://arrow.apache.org/docs/python/generated/pyarrow.fs.FileSystem.html">supported by pyarrow</a> can be used to specify file locations.
You can also create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> from existing data in the Ray object store or Ray-compatible distributed DataFrames:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create from CSV.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;s3://anonymous@air-example-data/iris.csv&quot;</span><span class="p">)</span>
<span class="c1"># Dataset(num_blocks=1, num_rows=150,</span>
<span class="c1">#         schema={sepal length (cm): double, sepal width (cm): double, </span>
<span class="c1">#         petal length (cm): double, petal width (cm): double, target: int64})</span>

<span class="c1"># Create from Parquet.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;s3://anonymous@air-example-data/iris.parquet&quot;</span><span class="p">)</span>
<span class="c1"># Dataset(num_blocks=1, num_rows=150,</span>
<span class="c1">#         schema={sepal.length: double, sepal.width: double, </span>
<span class="c1">#         petal.length: double, petal.width: double, variety: string})</span>

</pre></div>
</div>
<p class="sd-card-text">Datasets can be transformed in parallel using <code class="docutils literal notranslate"><span class="pre">.map()</span></code>.
Transformations are executed <em>eagerly</em> and block until the operation is finished.
Datasets also supports <code class="docutils literal notranslate"><span class="pre">.filter()</span></code> and <code class="docutils literal notranslate"><span class="pre">.flat_map()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># Create 10 blocks for parallelism.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># Dataset(num_blocks=10, num_rows=150,</span>
<span class="c1">#         schema={sepal.length: float64, sepal.width: float64,</span>
<span class="c1">#                 petal.length: float64, petal.width: float64, variety: object})</span>

<span class="c1"># Find rows with sepal.length &lt; 5.5 and petal.length &gt; 3.5.</span>
<span class="k">def</span> <span class="nf">transform_batch</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;sepal.length&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">5.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;petal.length&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">)]</span>

<span class="n">transformed_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map_batches</span><span class="p">(</span><span class="n">transform_batch</span><span class="p">,</span> <span class="n">batch_format</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">)</span>
<span class="c1"># Dataset(num_blocks=10, num_rows=3,</span>
<span class="c1">#         schema={sepal.length: float64, sepal.width: float64,</span>
<span class="c1">#                 petal.length: float64, petal.width: float64, variety: object})</span>

<span class="n">transformed_ds</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 5.2, &#39;sepal.width&#39;: 2.7,</span>
<span class="c1">#     &#39;petal.length&#39;: 3.9, &#39;petal.width&#39;: 1.4, &#39;variety&#39;: &#39;Versicolor&#39;}</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 5.4, &#39;sepal.width&#39;: 3.0,</span>
<span class="c1">#     &#39;petal.length&#39;: 4.5, &#39;petal.width&#39;: 1.5, &#39;variety&#39;: &#39;Versicolor&#39;}</span>
<span class="c1"># -&gt; {&#39;sepal.length&#39;: 4.9, &#39;sepal.width&#39;: 2.5,</span>
<span class="c1">#     &#39;petal.length&#39;: 4.5, &#39;petal.width&#39;: 1.7, &#39;variety&#39;: &#39;Virginica&#39;}</span>
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../data/data.html"><span class="doc">Learn more about Ray Data</span></a></span></p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Train: Distributed Model Training<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray Train abstracts away the complexity of setting up a distributed training
system.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
PyTorch</label><div class="sd-tab-content docutils">
<p class="sd-card-text">This example shows how you can use Ray Train with PyTorch.</p>
<p class="sd-card-text">To run this example install Ray Train and PyTorch packages:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[train]&quot;</span> torch torchvision
</pre></div>
</div>
</div>
<p class="sd-card-text">Set up your dataset and model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>

<span class="k">def</span> <span class="nf">get_dataset</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/tmp/data&quot;</span><span class="p">,</span>
        <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">(),</span>
    <span class="p">)</span>

<span class="k">class</span> <span class="nc">NeuralNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear_relu_stack</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_relu_stack</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">logits</span>
</pre></div>
</div>
<p class="sd-card-text">Now define your single-worker PyTorch training function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_func</span><span class="p">():</span>
    <span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">()</span>
    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">()</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">, loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">This training function can be executed with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_func</span><span class="p">()</span>
</pre></div>
</div>
<p class="sd-card-text">Convert this to a distributed multi-worker training function.</p>
<p class="sd-card-text">Use the <code class="docutils literal notranslate"><span class="pre">ray.train.torch.prepare_model</span></code> and
<code class="docutils literal notranslate"><span class="pre">ray.train.torch.prepare_data_loader</span></code> utility functions to
set up your model and data for distributed training.
This automatically wraps the model with <code class="docutils literal notranslate"><span class="pre">DistributedDataParallel</span></code>
and places it on the right device, and adds <code class="docutils literal notranslate"><span class="pre">DistributedSampler</span></code> to the DataLoaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">train</span>

<span class="k">def</span> <span class="nf">train_func_distributed</span><span class="p">():</span>
    <span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">()</span>
    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">prepare_data_loader</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">prepare_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">, loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Instantiate a <code class="docutils literal notranslate"><span class="pre">TorchTrainer</span></code>
with 4 workers, and use it to run the new training function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.train.torch</span> <span class="kn">import</span> <span class="n">TorchTrainer</span>
<span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">ScalingConfig</span>

<span class="c1"># For GPU Training, set `use_gpu` to True.</span>
<span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">TorchTrainer</span><span class="p">(</span>
    <span class="n">train_func_distributed</span><span class="p">,</span>
    <span class="n">scaling_config</span><span class="o">=</span><span class="n">ScalingConfig</span><span class="p">(</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
TensorFlow</label><div class="sd-tab-content docutils">
<p class="sd-card-text">This example shows how you can use Ray Train to set up <a class="reference external" href="https://www.tensorflow.org/tutorials/distribute/multi_worker_with_keras">Multi-worker training
with Keras</a>.</p>
<p class="sd-card-text">To run this example install Ray Train and Tensorflow packages:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[train]&quot;</span> tensorflow
</pre></div>
</div>
</div>
<p class="sd-card-text">Set up your dataset and model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">def</span> <span class="nf">mnist_dataset</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
    <span class="c1"># The `x` arrays are in uint8 and have values in the [0, 255] range.</span>
    <span class="c1"># You need to convert them to float32 with values in the [0, 1] range.</span>
    <span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">60000</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">()</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_dataset</span>


<span class="k">def</span> <span class="nf">build_and_compile_cnn_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputLayer</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
<p class="sd-card-text">Now define your single-worker TensorFlow training function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_func</span><span class="p">():</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">single_worker_dataset</span> <span class="o">=</span> <span class="n">mnist_dataset</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">single_worker_model</span> <span class="o">=</span> <span class="n">build_and_compile_cnn_model</span><span class="p">()</span>
    <span class="n">single_worker_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">single_worker_dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">This training function can be executed with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_func</span><span class="p">()</span>
</pre></div>
</div>
<p class="sd-card-text">Now convert this to a distributed multi-worker training function.</p>
<ol class="simple">
<li><p class="sd-card-text">Set the <em>global</em> batch size - each worker processes the same size
batch as in the single-worker code.</p></li>
<li><p class="sd-card-text">Choose your TensorFlow distributed training strategy. This examples
uses the <code class="docutils literal notranslate"><span class="pre">MultiWorkerMirroredStrategy</span></code>.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">train_func_distributed</span><span class="p">():</span>
    <span class="n">per_worker_batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="c1"># This environment variable will be set by Ray Train.</span>
    <span class="n">tf_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_CONFIG&#39;</span><span class="p">])</span>
    <span class="n">num_workers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tf_config</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">][</span><span class="s1">&#39;worker&#39;</span><span class="p">])</span>

    <span class="n">strategy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">MultiWorkerMirroredStrategy</span><span class="p">()</span>

    <span class="n">global_batch_size</span> <span class="o">=</span> <span class="n">per_worker_batch_size</span> <span class="o">*</span> <span class="n">num_workers</span>
    <span class="n">multi_worker_dataset</span> <span class="o">=</span> <span class="n">mnist_dataset</span><span class="p">(</span><span class="n">global_batch_size</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">strategy</span><span class="o">.</span><span class="n">scope</span><span class="p">():</span>
        <span class="c1"># Model building/compiling need to be within `strategy.scope()`.</span>
        <span class="n">multi_worker_model</span> <span class="o">=</span> <span class="n">build_and_compile_cnn_model</span><span class="p">()</span>

    <span class="n">multi_worker_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">multi_worker_dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Instantiate a <code class="docutils literal notranslate"><span class="pre">TensorflowTrainer</span></code>
with 4 workers, and use it to run the new training function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.train.tensorflow</span> <span class="kn">import</span> <span class="n">TensorflowTrainer</span>
<span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">ScalingConfig</span>

<span class="c1"># For GPU Training, set `use_gpu` to True.</span>
<span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">TensorflowTrainer</span><span class="p">(</span><span class="n">train_func_distributed</span><span class="p">,</span> <span class="n">scaling_config</span><span class="o">=</span><span class="n">ScalingConfig</span><span class="p">(</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">))</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../train/train.html"><span class="doc">Learn more about Ray Train</span></a></span></p>
</div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Tune: Hyperparameter Tuning at Scale<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><a class="reference internal" href="../tune.html"><span class="doc std std-doc">Tune</span></a> is a library for hyperparameter tuning at any scale.
With Tune, you can launch a multi-node distributed hyperparameter sweep in less than 10 lines of code.
Tune supports any deep learning framework, including PyTorch, TensorFlow, and Keras.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example, install Ray Tune:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[tune]&quot;</span>
</pre></div>
</div>
</div>
<p class="sd-card-text">This example runs a small grid search with an iterative training function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>  <span class="c1"># ①</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">}</span>


<span class="n">search_space</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># ②</span>
    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">grid_search</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>
    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
<span class="p">}</span>

<span class="n">tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">param_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">)</span>  <span class="c1"># ③</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">If TensorBoard is installed, automatically visualize all trial results:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tensorboard --logdir ~/ray_results
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../tune.html"><span class="doc">Learn more about Ray Tune</span></a></span></p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Serve: Scalable Model Serving<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><a class="reference internal" href="../serve/index.html"><span class="doc std std-doc">Ray Serve</span></a> is a scalable model-serving library built on Ray.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example, install Ray Serve and scikit-learn:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[serve]&quot;</span> scikit-learn
</pre></div>
</div>
</div>
<p class="sd-card-text">This example runs serves a scikit-learn gradient boosting classifier.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">starlette.requests</span> <span class="kn">import</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>

<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">serve</span>


<span class="c1"># Train model.</span>
<span class="n">iris_dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">iris_dataset</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>


<span class="nd">@serve</span><span class="o">.</span><span class="n">deployment</span><span class="p">(</span><span class="n">route_prefix</span><span class="o">=</span><span class="s2">&quot;/iris&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">BoostingModel</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_list</span> <span class="o">=</span> <span class="n">iris_dataset</span><span class="p">[</span><span class="s2">&quot;target_names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">())[</span><span class="s2">&quot;vector&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received http request with data </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">payload</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">human_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_list</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">human_name</span><span class="p">}</span>


<span class="c1"># Deploy model.</span>
<span class="n">serve</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">BoostingModel</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>

<span class="c1"># Query it!</span>
<span class="n">sample_request_input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;http://localhost:8000/iris&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">sample_request_input</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">As a result you will see <code class="docutils literal notranslate"><span class="pre">{&quot;result&quot;:</span> <span class="pre">&quot;versicolor&quot;}</span></code>.</p>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../serve/index.html"><span class="doc">Learn more about Ray Serve</span></a></span></p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> RLlib: Industry-Grade Reinforcement Learning<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><a class="reference internal" href="../rllib/index.html"><span class="doc std std-doc">RLlib</span></a> is an industry-grade library for reinforcement learning (RL) built on top of Ray.
RLlib offers high scalability and unified APIs for a variety of industry- and research applications.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example, install <code class="docutils literal notranslate"><span class="pre">rllib</span></code> and either <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> or <code class="docutils literal notranslate"><span class="pre">pytorch</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[rllib]&quot;</span> tensorflow  <span class="c1"># or torch</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">ray.rllib.algorithms.ppo</span> <span class="kn">import</span> <span class="n">PPOConfig</span>


<span class="c1"># Define your problem using python and Farama-Foundation&#39;s gymnasium API:</span>
<span class="k">class</span> <span class="nc">SimpleCorridor</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Corridor in which an agent must learn to move right to reach the exit.</span>

<span class="sd">    ---------------------</span>
<span class="sd">    | S | 1 | 2 | 3 | G |   S=start; G=goal; corridor_length=5</span>
<span class="sd">    ---------------------</span>

<span class="sd">    Possible actions to chose from are: 0=left; 1=right</span>
<span class="sd">    Observations are floats indicating the current field index, e.g. 0.0 for</span>
<span class="sd">    starting position, 1.0 for the field next to the starting position, etc..</span>
<span class="sd">    Rewards are -0.1 for all steps, except when reaching the goal (+1.0).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_pos</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;corridor_length&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># left and right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_pos</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the episode.</span>

<span class="sd">        Returns:</span>
<span class="sd">           Initial observation of the new episode and an info dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Return initial observation.</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span><span class="p">],</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes a single step in the episode given `action`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New observation, reward, terminated-flag, truncated-flag, info-dict (empty).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Walk left.</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="c1"># Walk right.</span>
        <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Set `terminated` flag when end of corridor (goal) reached.</span>
        <span class="n">terminated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_pos</span>
        <span class="n">truncated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># +1 when goal reached, otherwise -1.</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">terminated</span> <span class="k">else</span> <span class="o">-</span><span class="mf">0.1</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_pos</span><span class="p">],</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminated</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="p">{}</span>


<span class="c1"># Create an RLlib Algorithm instance from a PPOConfig object.</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">PPOConfig</span><span class="p">()</span><span class="o">.</span><span class="n">environment</span><span class="p">(</span>
        <span class="c1"># Env class to use (here: our gym.Env sub-class from above).</span>
        <span class="n">env</span><span class="o">=</span><span class="n">SimpleCorridor</span><span class="p">,</span>
        <span class="c1"># Config dict to be passed to our custom env&#39;s constructor.</span>
        <span class="c1"># Use corridor with 20 fields (including S and G).</span>
        <span class="n">env_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;corridor_length&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="c1"># Parallelize environment rollouts.</span>
    <span class="o">.</span><span class="n">rollouts</span><span class="p">(</span><span class="n">num_rollout_workers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># Construct the actual (PPO) algorithm object from the config.</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="c1"># Train for n iterations and report results (mean episode rewards).</span>
<span class="c1"># Since we have to move at least 19 times in the env to reach the goal and</span>
<span class="c1"># each move gives us -0.1 reward (except the last move at the end: +1.0),</span>
<span class="c1"># we can expect to reach an optimal episode reward of -0.1*18 + 1.0 = -0.8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iter: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">; avg. reward=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;episode_reward_mean&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Perform inference (action computations) based on given env observations.</span>
<span class="c1"># Note that we are using a slightly different env here (len 10 instead of 20),</span>
<span class="c1"># however, this should still work as the agent has (hopefully) learned</span>
<span class="c1"># to &quot;just always walk right!&quot;</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">SimpleCorridor</span><span class="p">({</span><span class="s2">&quot;corridor_length&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="c1"># Get the initial observation (should be: [0.0] for the starting position).</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">terminated</span> <span class="o">=</span> <span class="n">truncated</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">total_reward</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Play one episode.</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">terminated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">truncated</span><span class="p">:</span>
    <span class="c1"># Compute a single action, given the current observation</span>
    <span class="c1"># from the environment.</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">compute_single_action</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    <span class="c1"># Apply the computed action in the environment.</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminated</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="c1"># Sum up rewards for reporting purposes.</span>
    <span class="n">total_reward</span> <span class="o">+=</span> <span class="n">reward</span>
<span class="c1"># Report results.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Played 1 episode; total-reward=</span><span class="si">{</span><span class="n">total_reward</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../rllib/index.html"><span class="doc">Learn more about Ray RLlib</span></a></span></p>
</div>
</details></section>
<section id="ray-core-quickstart">
<h2>Ray Core Quickstart<a class="headerlink" href="getting-started.html#ray-core-quickstart" title="Permalink to this headline">#</a></h2>
<p>Turn functions and classes easily into Ray tasks and actors,
for Python and Java, with simple primitives for building and running distributed applications.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Core: Parallelizing Functions with Ray Tasks<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
Python</label><div class="sd-tab-content docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example install Ray Core:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray&quot;</span>
</pre></div>
</div>
</div>
<p class="sd-card-text">Import Ray and and initialize it with <code class="docutils literal notranslate"><span class="pre">ray.init()</span></code>.
Then decorate the function with <code class="docutils literal notranslate"><span class="pre">&#64;ray.remote</span></code> to declare that you want to run this function remotely.
Lastly, call the function with <code class="docutils literal notranslate"><span class="pre">.remote()</span></code> instead of calling it normally.
This remote call yields a future, a Ray <em>object reference</em>, that you can then fetch with <code class="docutils literal notranslate"><span class="pre">ray.get</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray</span>
<span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">futures</span><span class="p">))</span> <span class="c1"># [0, 1, 4, 9]</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-3">
Java</label><div class="sd-tab-content docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example, add the <a class="reference external" href="https://mvnrepository.com/artifact/io.ray/ray-api">ray-api</a> and <a class="reference external" href="https://mvnrepository.com/artifact/io.ray/ray-runtime">ray-runtime</a> dependencies in your project.</p>
</div>
<p class="sd-card-text">Use <code class="docutils literal notranslate"><span class="pre">Ray.init</span></code> to initialize Ray runtime.
Then use <code class="docutils literal notranslate"><span class="pre">Ray.task(...).remote()</span></code> to convert any Java static method into a Ray task.
The task runs asynchronously in a remote worker process. The <code class="docutils literal notranslate"><span class="pre">remote</span></code> method returns an <code class="docutils literal notranslate"><span class="pre">ObjectRef</span></code>,
and you can fetch the actual result with <code class="docutils literal notranslate"><span class="pre">get</span></code>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">io.ray.api.ObjectRef</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.ray.api.Ray</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w"></span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RayDemo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Intialize Ray runtime.</span><span class="w"></span>
<span class="w">        </span><span class="n">Ray</span><span class="p">.</span><span class="na">init</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ObjectRef</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">objectRefList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Invoke the `square` method 4 times remotely as Ray tasks.</span><span class="w"></span>
<span class="w">        </span><span class="c1">// The tasks will run in parallel in the background.</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">objectRefList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">Ray</span><span class="p">.</span><span class="na">task</span><span class="p">(</span><span class="n">RayDemo</span><span class="p">::</span><span class="n">square</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">).</span><span class="na">remote</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Get the actual results of the tasks.</span><span class="w"></span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Ray</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">objectRefList</span><span class="p">));</span><span class="w">  </span><span class="c1">// [0, 1, 4, 9]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p class="sd-card-text">In the above code block we defined some Ray Tasks. While these are great for stateless operations, sometimes you
must maintain the state of your application. You can do that with Ray Actors.</p>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-core/walkthrough.html"><span class="doc">Learn more about Ray Core</span></a></span></p>
</div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Core: Parallelizing Classes with Ray Actors<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray provides actors to allow you to parallelize an instance of a class in Python or Java.
When you instantiate a class that is a Ray actor, Ray will start a remote instance
of that class in the cluster. This actor can then execute remote method calls and
maintain its own internal state.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
Python</label><div class="sd-tab-content docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example install Ray Core:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray&quot;</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray</span>
<span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">()</span> <span class="c1"># Only call this once.</span>

<span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
<span class="k">class</span> <span class="nc">Counter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

<span class="n">counters</span> <span class="o">=</span> <span class="p">[</span><span class="n">Counter</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">increment</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">]</span>
<span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">futures</span><span class="p">))</span> <span class="c1"># [1, 1, 1, 1]</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-5">
Java</label><div class="sd-tab-content docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To run this example, add the <a class="reference external" href="https://mvnrepository.com/artifact/io.ray/ray-api">ray-api</a> and <a class="reference external" href="https://mvnrepository.com/artifact/io.ray/ray-runtime">ray-runtime</a> dependencies in your project.</p>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">io.ray.api.ActorHandle</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.ray.api.ObjectRef</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.ray.api.Ray</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span><span class="w"></span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RayDemo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Counter</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">increment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">read</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">value</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Intialize Ray runtime.</span><span class="w"></span>
<span class="w">        </span><span class="n">Ray</span><span class="p">.</span><span class="na">init</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ActorHandle</span><span class="o">&lt;</span><span class="n">Counter</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">counters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Create 4 actors from the `Counter` class.</span><span class="w"></span>
<span class="w">        </span><span class="c1">// They will run in remote worker processes.</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">counters</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">Ray</span><span class="p">.</span><span class="na">actor</span><span class="p">(</span><span class="n">Counter</span><span class="p">::</span><span class="k">new</span><span class="p">).</span><span class="na">remote</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Invoke the `increment` method on each actor.</span><span class="w"></span>
<span class="w">        </span><span class="c1">// This will send an actor task to each remote actor.</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ActorHandle</span><span class="o">&lt;</span><span class="n">Counter</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">counters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">counter</span><span class="p">.</span><span class="na">task</span><span class="p">(</span><span class="n">Counter</span><span class="p">::</span><span class="n">increment</span><span class="p">).</span><span class="na">remote</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Invoke the `read` method on each actor, and print the results.</span><span class="w"></span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ObjectRef</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">objectRefList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counters</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="na">task</span><span class="p">(</span><span class="n">Counter</span><span class="p">::</span><span class="n">read</span><span class="p">).</span><span class="na">remote</span><span class="p">())</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Ray</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">objectRefList</span><span class="p">));</span><span class="w">  </span><span class="c1">// [1, 1, 1, 1]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-core/walkthrough.html"><span class="doc">Learn more about Ray Core</span></a></span></p>
</div>
</div>
</div>
</details></section>
<section id="ray-cluster-quickstart">
<h2>Ray Cluster Quickstart<a class="headerlink" href="getting-started.html#ray-cluster-quickstart" title="Permalink to this headline">#</a></h2>
<p>Deploy your applications on Ray clusters, often with minimal code changes to your existing code.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Clusters: Launching a Ray Cluster on AWS<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray programs can run on a single machine, or seamlessly scale to large clusters.
Take this simple example that waits for individual nodes to join the cluster.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
example.py<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="kn">import</span> <span class="nn">ray</span>


<span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
<span class="k">def</span> <span class="nf">get_host_name</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">platform</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">(),)</span>


<span class="k">def</span> <span class="nf">wait_for_nodes</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
    <span class="c1"># Wait for all nodes to join the cluster.</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">num_nodes</span> <span class="o">&lt;</span> <span class="n">expected</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> nodes have joined so far, waiting for </span><span class="si">{}</span><span class="s2"> more.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">num_nodes</span><span class="p">,</span> <span class="n">expected</span> <span class="o">-</span> <span class="n">num_nodes</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">wait_for_nodes</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Check that objects can be transferred from each node to each other node.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iteration </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_host_name</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">get_host_name</span><span class="o">.</span><span class="n">remote</span><span class="p">(()))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">results</span><span class="p">)))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="s2">&quot;localhost:6379&quot;</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><p class="sd-card-text">You can also download this example from our <a class="reference external" href="https://github.com/ray-project/ray/blob/master/doc/yarn/example.py">GitHub repository</a>.
Go ahead and store it locally in a file called <code class="docutils literal notranslate"><span class="pre">example.py</span></code>.</p>
<p class="sd-card-text">To execute this script in the cloud, just download <a class="reference external" href="https://github.com/ray-project/ray/blob/master/python/ray/autoscaler/aws/example-full.yaml">this configuration file</a>,
or copy it here:</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
cluster.yaml<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># An unique identifier for the head node and workers of this cluster.</span><span class="w"></span>
<span class="nt">cluster_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>

<span class="c1"># The maximum number of workers nodes to launch in addition to the head</span><span class="w"></span>
<span class="c1"># node.</span><span class="w"></span>
<span class="nt">max_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>

<span class="c1"># The autoscaler will scale up the cluster faster with higher upscaling speed.</span><span class="w"></span>
<span class="c1"># E.g., if the task requires adding more nodes then autoscaler will gradually</span><span class="w"></span>
<span class="c1"># scale up the cluster in chunks of upscaling_speed*currently_running_nodes.</span><span class="w"></span>
<span class="c1"># This number should be &gt; 0.</span><span class="w"></span>
<span class="nt">upscaling_speed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w"></span>

<span class="c1"># This executes all commands on all nodes in the docker container,</span><span class="w"></span>
<span class="c1"># and opens all the necessary ports to support the Ray cluster.</span><span class="w"></span>
<span class="c1"># Empty string means disabled.</span><span class="w"></span>
<span class="nt">docker</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rayproject/ray-ml:latest-gpu&quot;</span><span class="w"> </span><span class="c1"># You can change this to latest-cpu if you don&#39;t need GPU support and want a faster startup</span><span class="w"></span>
<span class="w">    </span><span class="c1"># image: rayproject/ray:latest-cpu   # use this one if you don&#39;t need ML dependencies, it&#39;s faster to pull</span><span class="w"></span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ray_container&quot;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># If true, pulls latest version of image. Otherwise, `docker run` will only pull the image</span><span class="w"></span>
<span class="w">    </span><span class="c1"># if no cached version is present.</span><span class="w"></span>
<span class="w">    </span><span class="nt">pull_before_run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">    </span><span class="nt">run_options</span><span class="p">:</span><span class="w">   </span><span class="c1"># Extra options to pass into &quot;docker run&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--ulimit nofile=65536:65536</span><span class="w"></span>

<span class="w">    </span><span class="c1"># Example of running a GPU head with CPU workers</span><span class="w"></span>
<span class="w">    </span><span class="c1"># head_image: &quot;rayproject/ray-ml:latest-gpu&quot;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Allow Ray to automatically detect GPUs</span><span class="w"></span>

<span class="w">    </span><span class="c1"># worker_image: &quot;rayproject/ray-ml:latest-cpu&quot;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># worker_run_options: []</span><span class="w"></span>

<span class="c1"># If a node is idle for this many minutes, it will be removed.</span><span class="w"></span>
<span class="nt">idle_timeout_minutes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"></span>

<span class="c1"># Cloud-provider specific configuration.</span><span class="w"></span>
<span class="nt">provider</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws</span><span class="w"></span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-west-2</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Availability zone(s), comma-separated, that nodes may be launched in.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Nodes will be launched in the first listed availability zone and will</span><span class="w"></span>
<span class="w">    </span><span class="c1"># be tried in the subsequent availability zones if launching fails.</span><span class="w"></span>
<span class="w">    </span><span class="nt">availability_zone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-west-2a,us-west-2b</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Whether to allow node reuse. If set to False, nodes will be terminated</span><span class="w"></span>
<span class="w">    </span><span class="c1"># instead of stopped.</span><span class="w"></span>
<span class="w">    </span><span class="nt">cache_stopped_nodes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"> </span><span class="c1"># If not present, the default is True.</span><span class="w"></span>

<span class="c1"># How Ray will authenticate with newly launched nodes.</span><span class="w"></span>
<span class="nt">auth</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">ssh_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu</span><span class="w"></span>
<span class="c1"># By default Ray creates a new private keypair, but you can also use your own.</span><span class="w"></span>
<span class="c1"># If you do so, make sure to also set &quot;KeyName&quot; in the head and worker node</span><span class="w"></span>
<span class="c1"># configurations below.</span><span class="w"></span>
<span class="c1">#    ssh_private_key: /path/to/your/key.pem</span><span class="w"></span>

<span class="c1"># Tell the autoscaler the allowed node types and the resources they provide.</span><span class="w"></span>
<span class="c1"># The key is the name of the node type, which is just for debugging purposes.</span><span class="w"></span>
<span class="c1"># The node config specifies the launch config and physical instance type.</span><span class="w"></span>
<span class="nt">available_node_types</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">ray.head.default</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># The node type&#39;s CPU and GPU resources are auto-detected based on AWS instance type.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># If desired, you can override the autodetected CPU and GPU resources advertised to the autoscaler.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># You can also set custom resources.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># For example, to mark a node type as having 1 CPU, 1 GPU, and 5 units of a resource called &quot;custom&quot;, set</span><span class="w"></span>
<span class="w">        </span><span class="c1"># resources: {&quot;CPU&quot;: 1, &quot;GPU&quot;: 1, &quot;custom&quot;: 5}</span><span class="w"></span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">        </span><span class="c1"># Provider-specific config for this node type, e.g. instance type. By default</span><span class="w"></span>
<span class="w">        </span><span class="c1"># Ray will auto-configure unspecified fields such as SubnetId and KeyName.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># For more documentation on available fields, see:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># http://boto3.readthedocs.io/en/latest/reference/services/ec2.html#EC2.ServiceResource.create_instances</span><span class="w"></span>
<span class="w">        </span><span class="nt">node_config</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">InstanceType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m5.large</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Default AMI for us-west-2.</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Check https://github.com/ray-project/ray/blob/master/python/ray/autoscaler/_private/aws/config.py</span><span class="w"></span>
<span class="w">            </span><span class="c1"># for default images for other zones.</span><span class="w"></span>
<span class="w">            </span><span class="nt">ImageId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami-0387d929287ab193e</span><span class="w"></span>
<span class="w">            </span><span class="c1"># You can provision additional disk space with a conf as follows</span><span class="w"></span>
<span class="w">            </span><span class="nt">BlockDeviceMappings</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">DeviceName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/sda1</span><span class="w"></span>
<span class="w">                  </span><span class="nt">Ebs</span><span class="p">:</span><span class="w"></span>
<span class="w">                      </span><span class="nt">VolumeSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">140</span><span class="w"></span>
<span class="w">                      </span><span class="nt">VolumeType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gp3</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Additional options in the boto docs.</span><span class="w"></span>
<span class="w">    </span><span class="nt">ray.worker.default</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># The minimum number of worker nodes of this type to launch.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># This number should be &gt;= 0.</span><span class="w"></span>
<span class="w">        </span><span class="nt">min_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"></span>
<span class="w">        </span><span class="c1"># The maximum number of worker nodes of this type to launch.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># This takes precedence over min_workers.</span><span class="w"></span>
<span class="w">        </span><span class="nt">max_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<span class="w">        </span><span class="c1"># The node type&#39;s CPU and GPU resources are auto-detected based on AWS instance type.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># If desired, you can override the autodetected CPU and GPU resources advertised to the autoscaler.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># You can also set custom resources.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># For example, to mark a node type as having 1 CPU, 1 GPU, and 5 units of a resource called &quot;custom&quot;, set</span><span class="w"></span>
<span class="w">        </span><span class="c1"># resources: {&quot;CPU&quot;: 1, &quot;GPU&quot;: 1, &quot;custom&quot;: 5}</span><span class="w"></span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w"></span>
<span class="w">        </span><span class="c1"># Provider-specific config for this node type, e.g. instance type. By default</span><span class="w"></span>
<span class="w">        </span><span class="c1"># Ray will auto-configure unspecified fields such as SubnetId and KeyName.</span><span class="w"></span>
<span class="w">        </span><span class="c1"># For more documentation on available fields, see:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># http://boto3.readthedocs.io/en/latest/reference/services/ec2.html#EC2.ServiceResource.create_instances</span><span class="w"></span>
<span class="w">        </span><span class="nt">node_config</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">InstanceType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m5.large</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Default AMI for us-west-2.</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Check https://github.com/ray-project/ray/blob/master/python/ray/autoscaler/_private/aws/config.py</span><span class="w"></span>
<span class="w">            </span><span class="c1"># for default images for other zones.</span><span class="w"></span>
<span class="w">            </span><span class="nt">ImageId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami-0387d929287ab193e</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Run workers on spot by default. Comment this out to use on-demand.</span><span class="w"></span>
<span class="w">            </span><span class="c1"># NOTE: If relying on spot instances, it is best to specify multiple different instance</span><span class="w"></span>
<span class="w">            </span><span class="c1"># types to avoid interruption when one instance type is experiencing heightened demand.</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Demand information can be found at https://aws.amazon.com/ec2/spot/instance-advisor/</span><span class="w"></span>
<span class="w">            </span><span class="nt">InstanceMarketOptions</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="nt">MarketType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spot</span><span class="w"></span>
<span class="w">                </span><span class="c1"># Additional options can be found in the boto docs, e.g.</span><span class="w"></span>
<span class="w">                </span><span class="c1">#   SpotOptions:</span><span class="w"></span>
<span class="w">                </span><span class="c1">#       MaxPrice: MAX_HOURLY_PRICE</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Additional options in the boto docs.</span><span class="w"></span>

<span class="c1"># Specify the node type of the head node (as configured above).</span><span class="w"></span>
<span class="nt">head_node_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ray.head.default</span><span class="w"></span>

<span class="c1"># Files or directories to copy to the head and worker nodes. The format is a</span><span class="w"></span>
<span class="c1"># dictionary from REMOTE_PATH: LOCAL_PATH, e.g.</span><span class="w"></span>
<span class="nt">file_mounts</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"></span>
<span class="c1">#    &quot;/path1/on/remote/machine&quot;: &quot;/path1/on/local/machine&quot;,</span><span class="w"></span>
<span class="c1">#    &quot;/path2/on/remote/machine&quot;: &quot;/path2/on/local/machine&quot;,</span><span class="w"></span>
<span class="p p-Indicator">}</span><span class="w"></span>

<span class="c1"># Files or directories to copy from the head node to the worker nodes. The format is a</span><span class="w"></span>
<span class="c1"># list of paths. The same path on the head node will be copied to the worker node.</span><span class="w"></span>
<span class="c1"># This behavior is a subset of the file_mounts behavior. In the vast majority of cases</span><span class="w"></span>
<span class="c1"># you should just use file_mounts. Only use this if you know what you&#39;re doing!</span><span class="w"></span>
<span class="nt">cluster_synced_files</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>

<span class="c1"># Whether changes to directories in file_mounts or cluster_synced_files in the head node</span><span class="w"></span>
<span class="c1"># should sync to the worker node continuously</span><span class="w"></span>
<span class="nt">file_mounts_sync_continuously</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>

<span class="c1"># Patterns for files to exclude when running rsync up or rsync down</span><span class="w"></span>
<span class="nt">rsync_exclude</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/.git&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/.git/**&quot;</span><span class="w"></span>

<span class="c1"># Pattern files to use for filtering out files when running rsync up or rsync down. The file is searched for</span><span class="w"></span>
<span class="c1"># in the source directory and recursively through all subdirectories. For example, if .gitignore is provided</span><span class="w"></span>
<span class="c1"># as a value, the behavior will match git&#39;s behavior for finding and using .gitignore files.</span><span class="w"></span>
<span class="nt">rsync_filter</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;.gitignore&quot;</span><span class="w"></span>

<span class="c1"># List of commands that will be run before `setup_commands`. If docker is</span><span class="w"></span>
<span class="c1"># enabled, these commands will run outside the container and before docker</span><span class="w"></span>
<span class="c1"># is setup.</span><span class="w"></span>
<span class="nt">initialization_commands</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>

<span class="c1"># List of shell commands to run to set up nodes.</span><span class="w"></span>
<span class="nt">setup_commands</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Note: if you&#39;re developing Ray, you probably want to create a Docker image that</span><span class="w"></span>
<span class="w">    </span><span class="c1"># has your Ray repo pre-cloned. Then, you can replace the pip installs</span><span class="w"></span>
<span class="w">    </span><span class="c1"># below with a git checkout &lt;your_sha&gt; (and possibly a recompile).</span><span class="w"></span>
<span class="w">    </span><span class="c1"># To run the nightly version of ray (as opposed to the latest), either use a rayproject docker image</span><span class="w"></span>
<span class="w">    </span><span class="c1"># that has the &quot;nightly&quot; (e.g. &quot;rayproject/ray-ml:nightly-gpu&quot;) or uncomment the following line:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># - pip install -U &quot;ray[default] @ https://s3-us-west-2.amazonaws.com/ray-wheels/latest/ray-3.0.0.dev0-cp37-cp37m-manylinux2014_x86_64.whl&quot;</span><span class="w"></span>

<span class="c1"># Custom commands that will be run on the head node after common setup.</span><span class="w"></span>
<span class="nt">head_setup_commands</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>

<span class="c1"># Custom commands that will be run on worker nodes after common setup.</span><span class="w"></span>
<span class="nt">worker_setup_commands</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>

<span class="c1"># Command to start ray on the head node. You don&#39;t need to change this.</span><span class="w"></span>
<span class="nt">head_start_ray_commands</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ray stop</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ray start --head --port=6379 --object-manager-port=8076 --autoscaling-config=~/ray_bootstrap_config.yaml --dashboard-host=0.0.0.0</span><span class="w"></span>

<span class="c1"># Command to start ray on worker nodes. You don&#39;t need to change this.</span><span class="w"></span>
<span class="nt">worker_start_ray_commands</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ray stop</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ray start --address=$RAY_HEAD_IP:6379 --object-manager-port=8076</span><span class="w"></span>
</pre></div>
</div>
</div>
</details><p class="sd-card-text">Assuming you have stored this configuration in a file called <code class="docutils literal notranslate"><span class="pre">cluster.yaml</span></code>, you can now launch an AWS cluster as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ray submit cluster.yaml example.py --start
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-core/cluster/index.html#cluster-index"><span class="std std-ref">Learn more about launching Ray Clusters</span></a></span></p>
</div>
</details></section>
<section id="debugging-and-monitoring-quickstart">
<h2>Debugging and Monitoring Quickstart<a class="headerlink" href="getting-started.html#debugging-and-monitoring-quickstart" title="Permalink to this headline">#</a></h2>
<p>Use built-in observability tools to monitor and debug Ray applications and clusters.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Ray Dashboard: Web GUI to monitor and debug Ray<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray dashboard provides a visual interface that displays real-time system metrics, node-level resource monitoring, job profiling, and task visualizations. The dashboard is designed to help users understand the performance of their Ray applications and identify potential issues.</p>
<img alt="https://raw.githubusercontent.com/ray-project/Images/master/docs/new-dashboard/Dashboard-overview.png" class="align-center" src="https://raw.githubusercontent.com/ray-project/Images/master/docs/new-dashboard/Dashboard-overview.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To get started with the dashboard, install the default installation as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[default]&quot;</span>
</pre></div>
</div>
</div>
<p class="sd-card-text">Access the dashboard through the default URL, http://localhost:8265.</p>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-observability/getting-started.html#observability-getting-started"><span class="std std-ref">Learn more about Ray Dashboard</span></a></span></p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header">
<a class="reference internal" href="../_images/ray_svg_logo.svg"><img alt="ray" src="../_images/ray_svg_logo.svg" width="50px" /></a> Ray State APIs: CLI to access cluster states<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Ray state APIs allow users to conveniently access the current state (snapshot) of Ray through CLI or Python SDK.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">To get started with the state API, install the default installation as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -U <span class="s2">&quot;ray[default]&quot;</span>
</pre></div>
</div>
</div>
<p class="sd-card-text">Run the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">ray</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">num_cpus</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
    <span class="k">def</span> <span class="nf">task_running_300_seconds</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start!&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
    
    <span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
    <span class="k">class</span> <span class="nc">Actor</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Actor created&quot;</span><span class="p">)</span>
    
    <span class="c1"># Create 2 tasks</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">task_running_300_seconds</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

    <span class="c1"># Create 2 actors</span>
    <span class="n">actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">Actor</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

    <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">See the summarized statistics of Ray tasks using <code class="docutils literal notranslate"><span class="pre">ray</span> <span class="pre">summary</span> <span class="pre">tasks</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>    ray summary tasks
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    ======== Tasks Summary: 2022-07-22 08:54:38.332537 ========
    Stats:
    ------------------------------------
    total_actor_scheduled: 2
    total_actor_tasks: 0
    total_tasks: 2


    Table (group by func_name):
    ------------------------------------
        FUNC_OR_CLASS_NAME        STATE_COUNTS    TYPE
    0   task_running_300_seconds  RUNNING: 2      NORMAL_TASK
    1   Actor.__init__            FINISHED: 2     ACTOR_CREATION_TASK
</pre></div>
</div>
<p class="sd-card-text"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-outline-primary reference internal" href="../ray-observability/user-guides/cli-sdk.html#observability-programmatic"><span class="std std-ref">Learn more about Ray State APIs</span></a></span></p>
</div>
</details></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="learn-more">
<h1>Learn More<a class="headerlink" href="getting-started.html#learn-more" title="Permalink to this headline">#</a></h1>
<p>Here are some talks, papers, and press coverage involving Ray and its libraries.
Please raise an issue if any of the below links are broken, or if you’d like to add your own talk!</p>
<section id="blog-and-press">
<h2>Blog and Press<a class="headerlink" href="getting-started.html#blog-and-press" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://towardsdatascience.com/modern-parallel-and-distributed-python-a-quick-tutorial-on-ray-99f8d70369b8">Modern Parallel and Distributed Python: A Quick Tutorial on Ray</a></p></li>
<li><p><a class="reference external" href="https://www.datanami.com/2019/11/05/why-every-python-developer-will-love-ray/">Why Every Python Developer Will Love Ray</a></p></li>
<li><p><a class="reference external" href="http://bair.berkeley.edu/blog/2018/01/09/ray/">Ray: A Distributed System for AI (BAIR)</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/10x-faster-parallel-python-without-python-multiprocessing-e5017c93cce1">10x Faster Parallel Python Without Python Multiprocessing</a></p></li>
<li><p><a class="reference external" href="https://ray-project.github.io/2018/07/15/parameter-server-in-fifteen-lines.html">Implementing A Parameter Server in 15 Lines of Python with Ray</a></p></li>
<li><p><a class="reference external" href="https://rise.cs.berkeley.edu/blog/ray-intel-curriculum/">Ray Distributed AI Framework Curriculum</a></p></li>
<li><p><a class="reference external" href="https://medium.com/riselab/rayonspark-running-emerging-ai-applications-on-big-data-clusters-with-ray-and-analytics-zoo-923e0136ed6a">RayOnSpark: Running Emerging AI Applications on Big Data Clusters with Ray and Analytics Zoo</a></p></li>
<li><p><a class="reference external" href="https://rise.cs.berkeley.edu/blog/ray-tips-for-first-time-users/">First user tips for Ray</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/fast-hyperparameter-tuning-at-scale-d428223b081c">Tune: a Python library for fast hyperparameter tuning at any scale</a></p></li>
<li><p><a class="reference external" href="https://medium.com/riselab/cutting-edge-hyperparameter-tuning-with-ray-tune-be6c0447afdf">Cutting edge hyperparameter tuning with Ray Tune</a></p></li>
<li><p><a class="reference external" href="https://www.datanami.com/2018/02/01/rays-new-library-targets-high-speed-reinforcement-learning/">New Library Targets High Speed Reinforcement Learning</a></p></li>
<li><p><a class="reference external" href="http://bair.berkeley.edu/blog/2018/12/12/rllib/">Scaling Multi Agent Reinforcement Learning</a></p></li>
<li><p><a class="reference external" href="https://bair.berkeley.edu/blog/2019/10/14/functional-rl/">Functional RL with Keras and Tensorflow Eager</a></p></li>
<li><p><a class="reference external" href="https://www.kdnuggets.com/2019/11/speed-up-pandas-4x.html">How to Speed up Pandas by 4x with one line of code</a></p></li>
<li><p><a class="reference external" href="https://pythondata.com/quick-tip-speed-up-pandas-using-modin/">Quick Tip – Speed up Pandas using Modin</a></p></li>
<li><p><a class="reference external" href="https://medium.com/distributed-computing-with-ray">Ray Blog</a></p></li>
</ul>
</section>
<section id="talks-videos">
<h2>Talks (Videos)<a class="headerlink" href="getting-started.html#talks-videos" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://zoom.us/rec/share/0cjbk_YdCTbiTm7gNhzSeNxxTCCEy1pCDUkkjfBjtvOsKGA8XmDOx82jflHdQCUP.fsjQkj5PWSYplOTz?startTime=1635456658000">Unifying Large Scale Data Preprocessing and Machine Learning Pipelines with Ray Data | PyData 2021</a> <a class="reference external" href="https://docs.google.com/presentation/d/19F_wxkpo1JAROPxULmJHYZd3sKryapkbMd0ib3ndMiU/edit?usp=sharing">(slides)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=LfpHyIXBhlE">Programming at any Scale with Ray | SF Python Meetup Sept 2019</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=Ayc0ca150HI">Ray for Reinforcement Learning | Data Council 2019</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=-HjLd_3ahCw">Scaling Interactive Pandas Workflows with Modin</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=D_oz7E4v-U0">Ray: A Distributed Execution Framework for AI | SciPy 2018</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=xadZRRB_TeI">Ray: A Cluster Computing Engine for Reinforcement Learning Applications | Spark Summit</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=eeRGORQthaQ">RLlib: Ray Reinforcement Learning Library | RISECamp 2018</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=jAEPqjkjth4">Enabling Composition in Distributed Reinforcement Learning | Spark Summit 2018</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=38Yd_dXW51Q">Tune: Distributed Hyperparameter Search | RISECamp 2018</a></p></li>
</ul>
</section>
<section id="slides">
<h2>Slides<a class="headerlink" href="getting-started.html#slides" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.google.com/presentation/d/1sF5T_ePR9R6fAi2R6uxehHzXuieme63O2n_5i9m7mVE/edit?usp=sharing">Talk given at UC Berkeley DS100</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/presentation/d/13K0JsogYQX3gUCGhmQ1PQ8HILwEDFysnq0cI2b88XbU/edit?usp=sharing">Talk given in October 2019</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/presentation/d/1v3IldXWrFNMK-vuONlSdEuM82fuGTrNUDuwtfx4axsQ/edit?usp=sharing">Talk given at RISECamp 2019</a></p></li>
</ul>
</section>
<section id="papers">
<h2>Papers<a class="headerlink" href="getting-started.html#papers" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.google.com/document/d/1tBw9A4j62ruI5omIJbMxly-la5w4q_TjyJgJL_jN2fI/preview">Ray 2.0 Architecture whitepaper</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/document/d/1lAy0Owi-vPz2jEqBSaHNQcy2IBSDEHyXNOQZlGuj93c/preview">Ray 1.0 Architecture whitepaper (old)</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/document/d/1bYL-638GN6EeJ45dPuLiPImA8msojEDDKiBx3YzB4_s/preview">Ray AIR Technical whitepaper</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2203.05072">Exoshuffle: large-scale data shuffle in Ray</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1712.09381">RLlib paper</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2011.12719">RLlib flow paper</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1807.05118">Tune paper</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1712.05889">Ray paper (old)</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1703.03924">Ray HotOS paper (old)</a></p></li>
</ul>
<a class="reference external image-reference" href="https://ray-docs-promo.netlify.app/overview"><img alt="" src="https://ray-docs-promo.netlify.app/assets/img/overview/bottom.png" /></a>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Overview</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../ray-more-libs/installation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Installing Ray</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2023, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf"></script>


  </body>
</html>