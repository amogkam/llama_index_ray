
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(Advanced) Deploying a static Ray cluster without KubeRay &#8212; Ray 3.0.0.dev0</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css@digest=5115cc725059bd94278eecd172e13a965bf8f5a9.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_/static/css/badge_only.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/versionwarning.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../../../_static/js/docsearch.js"></script>
    <script src="../../../_static/js/rate-the-docs.es.min.js"></script>
    <script defer="defer" src="../../../_static/js/termynal.js"></script>
    <script defer="defer" src="../../../_static/js/custom.js"></script>
    <script defer="defer" src="../../../_static/js/top-navigation.js"></script>
    <script src="../../../_static/js/tags.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js@digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="../../../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/cluster/kubernetes/user-guides/static-ray-cluster-without-kuberay.html" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Examples" href="../examples.html" />
    <link rel="prev" title="Experimental Features" href="experimental.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  
<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": true, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "cluster/kubernetes/user-guides/static-ray-cluster-without-kuberay", "programming_language": "py", "project": "ray", "proxied_api_host": "/_", "source_suffix": ".md", "subprojects": {}, "theme": "sphinx_book_theme", "user_analytics_code": "", "version": "master"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 3.0.0.dev0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    Welcome to Ray!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/index.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-more-libs/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/use-cases.html">
   Use Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/examples.html">
   Example Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/ray-libraries.html">
   Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-core/walkthrough.html">
   Ray Core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-air/getting-started.html">
   Ray AI Runtime (AIR)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../data/data.html">
   Ray Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../train/train.html">
   Ray Train
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../tune.html">
   Ray Tune
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../serve/index.html">
   Ray Serve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../rllib/index.html">
   Ray RLlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-more-libs/index.html">
   More Libraries
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../../ray-core/cluster/index.html">
   Ray Clusters
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../key-concepts.html">
     Key Concepts
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     Deploying on Kubernetes
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="../getting-started.html">
       Getting Started
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="../user-guides.html">
       User Guides
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="k8s-cluster-setup.html">
         Managed Kubernetes services
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="config.html">
         RayCluster Configuration
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="configuring-autoscaling.html">
         KubeRay Autoscaling
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="logging.html">
         Log Persistence
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="gpu.html">
         Using GPUs
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="experimental.html">
         Experimental Features
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="static-ray-cluster-without-kuberay.html#">
         (Advanced) Deploying a static Ray cluster without KubeRay
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../examples.html">
       Examples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../references.html">
       API Reference
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../vms/index.html">
     Deploying on VMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../metrics.html">
     Collecting and monitoring metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../configure-manage-dashboard.html">
     Configuring and Managing Ray Dashboard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../running-applications/index.html">
     Applications Guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../faq.html">
     FAQ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../package-overview.html">
     Ray Cluster Management API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-observability/index.html">
   Monitoring and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-references/api.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-contribute/stability.html">
   Developer Guides
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Fcluster/kubernetes/user-guides/static-ray-cluster-without-kuberay.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/cluster/kubernetes/user-guides/static-ray-cluster-without-kuberay.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/cluster/kubernetes/user-guides/static-ray-cluster-without-kuberay.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#preparation">
   Preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#install-the-latest-ray-release">
     Install the latest Ray release
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#install-kubectl">
     Install kubectl
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#access-a-kubernetes-cluster">
     Access a Kubernetes cluster
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-redis-for-fault-tolerance">
     Deploying a Redis for fault tolerance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-static-ray-cluster">
   Deploying a static Ray cluster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-network-policy-for-the-static-ray-cluster">
   Deploying a network policy for the static Ray cluster
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#external-redis-integration-for-fault-tolerance">
     External Redis Integration for fault tolerance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#running-applications-on-the-static-ray-cluster">
   Running Applications on the static Ray Cluster
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#accessing-the-cluster-with-kubectl-exec">
     Accessing the cluster with kubectl exec
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#ray-job-submission">
     Ray Job submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#cleanup">
   Cleanup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deleting-a-ray-cluster">
     Deleting a Ray Cluster
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>(Advanced) Deploying a static Ray cluster without KubeRay</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#preparation">
   Preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#install-the-latest-ray-release">
     Install the latest Ray release
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#install-kubectl">
     Install kubectl
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#access-a-kubernetes-cluster">
     Access a Kubernetes cluster
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-redis-for-fault-tolerance">
     Deploying a Redis for fault tolerance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-static-ray-cluster">
   Deploying a static Ray cluster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deploying-a-network-policy-for-the-static-ray-cluster">
   Deploying a network policy for the static Ray cluster
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#external-redis-integration-for-fault-tolerance">
     External Redis Integration for fault tolerance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#running-applications-on-the-static-ray-cluster">
   Running Applications on the static Ray Cluster
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#accessing-the-cluster-with-kubectl-exec">
     Accessing the cluster with kubectl exec
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#ray-job-submission">
     Ray Job submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#cleanup">
   Cleanup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="static-ray-cluster-without-kuberay.html#deleting-a-ray-cluster">
     Deleting a Ray Cluster
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="advanced-deploying-a-static-ray-cluster-without-kuberay">
<span id="deploy-a-static-ray-cluster-without-kuberay"></span><h1>(Advanced) Deploying a static Ray cluster without KubeRay<a class="headerlink" href="static-ray-cluster-without-kuberay.html#advanced-deploying-a-static-ray-cluster-without-kuberay" title="Permalink to this headline">#</a></h1>
<p>This deployment method for Ray no longer requires the use of CustomResourceDefinitions (CRDs).
In contrast, the CRDs is a prerequisite to use KubeRay. One of its key components, the KubeRay operator,
manages the Ray cluster resources by watching for Kubernetes events (create/delete/update).
Although the KubeRay operator can function within a single namespace, the use of CRDs has a cluster-wide scope.
If the necessary Kubernetes admin permissions are not available for deploying KubeRay, this doc introduces a way to deploy a static Ray cluster to Kubernetes without using KubeRay. However, it should be noted that this deployment method lacks the built-in
autoscaling feature that KubeRay provides.</p>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="static-ray-cluster-without-kuberay.html#preparation" title="Permalink to this headline">#</a></h2>
<section id="install-the-latest-ray-release">
<h3>Install the latest Ray release<a class="headerlink" href="static-ray-cluster-without-kuberay.html#install-the-latest-ray-release" title="Permalink to this headline">#</a></h3>
<p>This step is necessary for interacting with remote clusters using <a class="reference internal" href="../../running-applications/job-submission/index.html#jobs-overview"><span class="std std-ref">Ray Job Submission</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! pip install -U &quot;ray[default]&quot;
</pre></div>
</div>
<p>See <a class="reference internal" href="../../../ray-more-libs/installation.html#installation"><span class="std std-ref">Installing Ray</span></a> for more details.</p>
</section>
<section id="install-kubectl">
<h3>Install kubectl<a class="headerlink" href="static-ray-cluster-without-kuberay.html#install-kubectl" title="Permalink to this headline">#</a></h3>
<p>To interact with Kubernetes, we will use kubectl. Installation instructions can be found in the <a class="reference external" href="https://kubernetes.io/docs/tasks/tools/#kubectl">Kubernetes documentation</a>.</p>
</section>
<section id="access-a-kubernetes-cluster">
<h3>Access a Kubernetes cluster<a class="headerlink" href="static-ray-cluster-without-kuberay.html#access-a-kubernetes-cluster" title="Permalink to this headline">#</a></h3>
<p>We will need access to a Kubernetes cluster. There are two options:</p>
<ol class="simple">
<li><p>Configure access to a remote Kubernetes cluster
<strong>OR</strong></p></li>
<li><p>Run the examples locally by <a class="reference external" href="https://kind.sigs.k8s.io/docs/user/quick-start/#installation">installing kind</a>. Start your <a class="reference external" href="https://kind.sigs.k8s.io/">kind</a> cluster by running the following command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kind create cluster
</pre></div>
</div>
<p>To execute the example in this guide, ensure that your Kubernetes cluster (or local Kind cluster) can handle additional resource requests of 3 CPU and 3Gi memory.
Also, ensure that both your Kubernetes cluster and Kubectl are at least version 1.19.</p>
</section>
<section id="deploying-a-redis-for-fault-tolerance">
<h3>Deploying a Redis for fault tolerance<a class="headerlink" href="static-ray-cluster-without-kuberay.html#deploying-a-redis-for-fault-tolerance" title="Permalink to this headline">#</a></h3>
<p>Note that <a class="reference external" href="https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster.with-fault-tolerance.yaml">the Kubernetes deployment config file</a> has a section to deploy a Redis to Kubernetes so that the Ray head can write through the GCS metadata.
If a Redis has already been deployed on Kubernetes, this section can be omitted.</p>
</section>
</section>
<section id="deploying-a-static-ray-cluster">
<h2>Deploying a static Ray cluster<a class="headerlink" href="static-ray-cluster-without-kuberay.html#deploying-a-static-ray-cluster" title="Permalink to this headline">#</a></h2>
<p>In this section, we will deploy a static Ray cluster into the <code class="docutils literal notranslate"><span class="pre">default</span></code> namespace without using KubeRay. To use another
namespace, specify the namespace in your kubectl commands:</p>
<p><code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">-n</span> <span class="pre">&lt;your-namespace&gt;</span> <span class="pre">...</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Deploy a sample Ray Cluster from the Ray repo:

! kubectl apply -f https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster.with-fault-tolerance.yaml

# Note that the Ray cluster has fault tolerance enabled by default using the external Redis. 
# Please set the Redis IP address in the config.

# The password is currently set as &#39;&#39; for the external Redis. 
# Please download the config file and substitute the real password for the empty string if the external Redis has a password.
</pre></div>
</div>
<p>Once the Ray cluster has been deployed, you can view the pods for the head node and worker nodes by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl get pods

# NAME                                             READY   STATUS    RESTARTS   AGE
# deployment-ray-head-xxxxx                        1/1     Running   0          XXs
# deployment-ray-worker-xxxxx                      1/1     Running   0          XXs
# deployment-ray-worker-xxxxx                      1/1     Running   0          XXs
</pre></div>
</div>
<p>Wait for the pods to reach the <code class="docutils literal notranslate"><span class="pre">Running</span></code> state. This may take a few minutes – most of this time is spent downloading the Ray images.
In a separate shell, you may wish to observe the pods’ status in real-time with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># If you&#39;re on MacOS, first `brew install watch`.
# Run in a separate shell:

! watch -n 1 kubectl get pod
</pre></div>
</div>
<p>If your pods are stuck in the <code class="docutils literal notranslate"><span class="pre">Pending</span></code> state, you can check for errors via <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">describe</span> <span class="pre">pod</span> <span class="pre">deployment-ray-head-xxxx-xxxxx</span></code>
and ensure that your Docker resource limits are set high enough.</p>
<p>Note that in production scenarios, you will want to use larger Ray pods. In fact, it is advantageous to size each Ray pod to take up an entire Kubernetes node. See the <a class="reference internal" href="config.html#kuberay-config"><span class="std std-ref">configuration guide</span></a> for more details.</p>
</section>
<section id="deploying-a-network-policy-for-the-static-ray-cluster">
<h2>Deploying a network policy for the static Ray cluster<a class="headerlink" href="static-ray-cluster-without-kuberay.html#deploying-a-network-policy-for-the-static-ray-cluster" title="Permalink to this headline">#</a></h2>
<p>If your Kubernetes has a default deny network policy for pods, you need to manually create a network policy to allow bidirectional
communication among the head and worker nodes in the Ray cluster as mentioned in <a class="reference external" href="https://docs.ray.io/en/latest/ray-core/configure.html#ports-configurations">the ports configurations doc</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Create a sample network policy for the static Ray cluster from the Ray repo:
! kubectl apply -f https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster-networkpolicy.yaml
</pre></div>
</div>
<p>Once the network policy has been deployed, you can view the network policy for the static Ray cluster by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl get networkpolicies

# NAME                               POD-SELECTOR                           AGE
# ray-head-egress                    app=ray-cluster-head                   XXs
# ray-head-ingress                   app=ray-cluster-head                   XXs
# ray-worker-egress                  app=ray-cluster-worker                 XXs
# ray-worker-ingress                 app=ray-cluster-worker                 XXs
</pre></div>
</div>
<section id="external-redis-integration-for-fault-tolerance">
<h3>External Redis Integration for fault tolerance<a class="headerlink" href="static-ray-cluster-without-kuberay.html#external-redis-integration-for-fault-tolerance" title="Permalink to this headline">#</a></h3>
<p>Ray by default uses an internal key-value store, called the Global Control Store (GCS). The GCS runs on the head node and stores cluster
metadata. One drawback of this approach is that the head node loses the metadata if it crashes.
Ray can also write this metadata to an external Redis for reliability and high availability.
With this setup, the static Ray cluster can recover from head node crashes and tolerate GCS failures without losing connections to worker nodes.</p>
<p>To use this feature, we need to pass in the <code class="docutils literal notranslate"><span class="pre">RAY_REDIS_ADDRESS</span></code> env var and <code class="docutils literal notranslate"><span class="pre">--redis-password</span></code> in the Ray head node section of <a class="reference external" href="https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster.with-fault-tolerance.yaml">the Kubernetes deployment config file</a>.</p>
</section>
</section>
<section id="running-applications-on-the-static-ray-cluster">
<h2>Running Applications on the static Ray Cluster<a class="headerlink" href="static-ray-cluster-without-kuberay.html#running-applications-on-the-static-ray-cluster" title="Permalink to this headline">#</a></h2>
<p>In this section, we will interact with the static Ray cluster that just got deployed.</p>
<section id="accessing-the-cluster-with-kubectl-exec">
<h3>Accessing the cluster with kubectl exec<a class="headerlink" href="static-ray-cluster-without-kuberay.html#accessing-the-cluster-with-kubectl-exec" title="Permalink to this headline">#</a></h3>
<p>Same as the Ray cluster that deployed using KubeRay, we can exec directly into the head pod and run a Ray program.</p>
<p>Firstly, run the command below to get the head pod:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl get pods --selector=app=ray-cluster-head

# NAME                                             READY   STATUS    RESTARTS   AGE
# deployment-ray-head-xxxxx                        1/1     Running   0          XXs
</pre></div>
</div>
<p>We can now execute a Ray program on the previously identified head pod. The following command connects to the Ray Cluster and then terminates the Ray program.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Substitute your output from the last cell in place of &quot;deployment-ray-head-xxxxx&quot;

! kubectl exec deployment-ray-head-xxxxx -it -c ray-head -- python -c &quot;import ray; ray.init(&#39;auto&#39;)&quot;
# 2022-08-10 11:23:17,093 INFO worker.py:1312 -- Connecting to existing Ray cluster at address: &lt;IP address&gt;:6380...
# 2022-08-10 11:23:17,097 INFO worker.py:1490 -- Connected to Ray cluster. View the dashboard at ...
</pre></div>
</div>
<p>Although the above cell can be useful for occasional execution on the Ray Cluster, the recommended approach for running an application on a Ray Cluster is to use <a class="reference internal" href="../../running-applications/job-submission/quickstart.html#jobs-quickstart"><span class="std std-ref">Ray Jobs</span></a>.</p>
</section>
<section id="ray-job-submission">
<h3>Ray Job submission<a class="headerlink" href="static-ray-cluster-without-kuberay.html#ray-job-submission" title="Permalink to this headline">#</a></h3>
<p>To set up your Ray Cluster for Ray Jobs submission, it is necessary to ensure that the Ray Jobs port is accessible to the client.
Ray receives job requests through the Dashboard server on the head node.</p>
<p>First, we need to identify the Ray head node. The static Ray cluster configuration file sets up a
<a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes service</a> that targets the Ray head pod.
This service lets us interact with Ray clusters without directly executing commands in the Ray container.
To identify the Ray head service for our example cluster, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl get service service-ray-cluster

# NAME                             TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                            AGE
# service-ray-cluster              ClusterIP   10.92.118.20   &lt;none&gt;        6380/TCP,8265/TCP,10001/TCP...     XXs
</pre></div>
</div>
<p>Now that we have the name of the service, we can use port-forwarding to access the Ray Dashboard port (8265 by default).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Execute this in a separate shell.
# Substitute the service name in place of service-ray-cluster

! kubectl port-forward service/service-ray-cluster 8265:8265
</pre></div>
</div>
<p>Now that we have access to the Dashboard port, we can submit jobs to the Ray Cluster for execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! ray job submit --address http://localhost:8265 -- python -c &quot;import ray; ray.init(); print(ray.cluster_resources())&quot;
</pre></div>
</div>
</section>
</section>
<section id="cleanup">
<h2>Cleanup<a class="headerlink" href="static-ray-cluster-without-kuberay.html#cleanup" title="Permalink to this headline">#</a></h2>
<section id="deleting-a-ray-cluster">
<h3>Deleting a Ray Cluster<a class="headerlink" href="static-ray-cluster-without-kuberay.html#deleting-a-ray-cluster" title="Permalink to this headline">#</a></h3>
<p>Delete the static Ray cluster service and deployments</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl delete -f https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster.with-fault-tolerance.yaml
</pre></div>
</div>
<p>Delete the static Ray cluster network policy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! kubectl delete -f https://raw.githubusercontent.com/ray-project/ray/master/doc/source/cluster/kubernetes/configs/static-ray-cluster-networkpolicy.yaml
</pre></div>
</div>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="experimental.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Experimental Features</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../examples.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Examples</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2023, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf"></script>


  </body>
</html>