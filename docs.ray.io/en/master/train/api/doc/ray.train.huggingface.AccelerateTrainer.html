
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ray.train.huggingface.AccelerateTrainer &#8212; Ray 3.0.0.dev0</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css@digest=1999514e3f237ded88cf.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css@digest=5115cc725059bd94278eecd172e13a965bf8f5a9.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_/static/css/badge_only.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/versionwarning.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../../../_static/js/docsearch.js"></script>
    <script src="../../../_static/js/rate-the-docs.es.min.js"></script>
    <script defer="defer" src="../../../_static/js/termynal.js"></script>
    <script defer="defer" src="../../../_static/js/custom.js"></script>
    <script defer="defer" src="../../../_static/js/top-navigation.js"></script>
    <script src="../../../_static/js/tags.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js@digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="../../../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/train/api/doc/ray.train.huggingface.AccelerateTrainer.html" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ray.train.huggingface.AccelerateTrainer.can_restore" href="ray.train.huggingface.AccelerateTrainer.can_restore.html" />
    <link rel="prev" title="ray.train.huggingface.TransformersCheckpoint.uri" href="ray.train.huggingface.TransformersCheckpoint.uri.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  
<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": true, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "train/api/doc/ray.train.huggingface.AccelerateTrainer", "programming_language": "py", "project": "ray", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_book_theme", "user_analytics_code": "", "version": "master"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 3.0.0.dev0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    Welcome to Ray!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/index.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-more-libs/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/use-cases.html">
   Use Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/examples.html">
   Example Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-overview/ray-libraries.html">
   Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-core/walkthrough.html">
   Ray Core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-air/getting-started.html">
   Ray AI Runtime (AIR)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../data/data.html">
   Ray Data
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../train.html">
   Ray Train
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../getting-started.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../key-concepts.html">
     Key Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guides.html">
     User Guides
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples.html">
     Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../faq.html">
     Ray Train FAQ
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../api.html">
     Ray Train API
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.html">
       ray.train.trainer.BaseTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.data_parallel_trainer.DataParallelTrainer.html">
       ray.train.data_parallel_trainer.DataParallelTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.data_config.DataConfig.html">
       ray.train.data_config.DataConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.gbdt_trainer.GBDTTrainer.html">
       ray.train.gbdt_trainer.GBDTTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.fit.html">
       ray.train.trainer.BaseTrainer.fit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.setup.html">
       ray.train.trainer.BaseTrainer.setup
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.preprocess_datasets.html">
       ray.train.trainer.BaseTrainer.preprocess_datasets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.training_loop.html">
       ray.train.trainer.BaseTrainer.training_loop
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.as_trainable.html">
       ray.train.trainer.BaseTrainer.as_trainable
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.backend.Backend.html">
       ray.train.backend.Backend
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.backend.BackendConfig.html">
       ray.train.backend.BackendConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.TorchTrainer.html">
       ray.train.torch.TorchTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.TorchConfig.html">
       ray.train.torch.TorchConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.TorchCheckpoint.html">
       ray.train.torch.TorchCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.prepare_model.html">
       ray.train.torch.prepare_model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.prepare_optimizer.html">
       ray.train.torch.prepare_optimizer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.prepare_data_loader.html">
       ray.train.torch.prepare_data_loader
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.get_device.html">
       ray.train.torch.get_device
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.accelerate.html">
       ray.train.torch.accelerate
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.backward.html">
       ray.train.torch.backward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.torch.enable_reproducibility.html">
       ray.train.torch.enable_reproducibility
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightning.LightningTrainer.html">
       ray.train.lightning.LightningTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightning.LightningConfigBuilder.html">
       ray.train.lightning.LightningConfigBuilder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightning.LightningCheckpoint.html">
       ray.train.lightning.LightningCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightning.LightningPredictor.html">
       ray.train.lightning.LightningPredictor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.tensorflow.TensorflowTrainer.html">
       ray.train.tensorflow.TensorflowTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.tensorflow.TensorflowConfig.html">
       ray.train.tensorflow.TensorflowConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.tensorflow.TensorflowCheckpoint.html">
       ray.train.tensorflow.TensorflowCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.tensorflow.prepare_dataset_shard.html">
       ray.train.tensorflow.prepare_dataset_shard
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.horovod.HorovodTrainer.html">
       ray.train.horovod.HorovodTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.horovod.HorovodConfig.html">
       ray.train.horovod.HorovodConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.xgboost.XGBoostTrainer.html">
       ray.train.xgboost.XGBoostTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.xgboost.XGBoostCheckpoint.html">
       ray.train.xgboost.XGBoostCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightgbm.LightGBMTrainer.html">
       ray.train.lightgbm.LightGBMTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.lightgbm.LightGBMCheckpoint.html">
       ray.train.lightgbm.LightGBMCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.huggingface.TransformersTrainer.html">
       ray.train.huggingface.TransformersTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.huggingface.TransformersCheckpoint.html">
       ray.train.huggingface.TransformersCheckpoint
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="current reference internal" href="ray.train.huggingface.AccelerateTrainer.html#">
       ray.train.huggingface.AccelerateTrainer
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.can_restore.html">
         ray.train.huggingface.AccelerateTrainer.can_restore
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.fit.html">
         ray.train.huggingface.AccelerateTrainer.fit
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.get_dataset_config.html">
         ray.train.huggingface.AccelerateTrainer.get_dataset_config
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.restore.html">
         ray.train.huggingface.AccelerateTrainer.restore
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.setup.html">
         ray.train.huggingface.AccelerateTrainer.setup
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.sklearn.SklearnTrainer.html">
       ray.train.sklearn.SklearnTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.sklearn.SklearnCheckpoint.html">
       ray.train.sklearn.SklearnCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.mosaic.MosaicTrainer.html">
       ray.train.mosaic.MosaicTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.rl.RLTrainer.html">
       ray.train.rl.RLTrainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.rl.RLCheckpoint.html">
       ray.train.rl.RLCheckpoint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.trainer.BaseTrainer.restore.html">
       ray.train.trainer.BaseTrainer.restore
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ray.train.data_parallel_trainer.DataParallelTrainer.restore.html">
       ray.train.data_parallel_trainer.DataParallelTrainer.restore
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../tune.html">
   Ray Tune
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../serve/index.html">
   Ray Serve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../rllib/index.html">
   Ray RLlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-more-libs/index.html">
   More Libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-core/cluster/index.html">
   Ray Clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-observability/index.html">
   Monitoring and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-references/api.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ray-contribute/stability.html">
   Developer Guides
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Ftrain/api/doc/ray.train.huggingface.AccelerateTrainer.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/train/api/doc/ray.train.huggingface.AccelerateTrainer.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/train/api/doc/ray.train.huggingface.AccelerateTrainer.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>ray.train.huggingface.AccelerateTrainer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="ray-train-huggingface-acceleratetrainer">
<h1>ray.train.huggingface.AccelerateTrainer<a class="headerlink" href="ray.train.huggingface.AccelerateTrainer.html#ray-train-huggingface-acceleratetrainer" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="ray.train.huggingface.AccelerateTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ray.train.huggingface.</span></span><span class="sig-name descname"><span class="pre">AccelerateTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ray/train/huggingface/accelerate/accelerate_trainer.html#AccelerateTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="ray.train.huggingface.AccelerateTrainer.html#ray.train.huggingface.AccelerateTrainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="ray.train.torch.TorchTrainer.html#ray.train.torch.TorchTrainer" title="ray.train.torch.torch_trainer.TorchTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ray.train.torch.torch_trainer.TorchTrainer</span></code></a></p>
<p>A Trainer for data parallel HuggingFace Accelerate training with PyTorch.</p>
<p>This Trainer is a wrapper around the <a class="reference internal" href="ray.train.torch.TorchTrainer.html#ray.train.torch.TorchTrainer" title="ray.train.torch.TorchTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchTrainer</span></code></a>,
providing the following extra functionality:
1. Loading and parsing of Accelerate configuration files (created by
<code class="docutils literal notranslate"><span class="pre">accelerate</span> <span class="pre">config</span></code> CLI command),
2. Applying the configuration files on all workers, making sure the environment
is set up correctly.</p>
<p>This Trainer runs the function <code class="docutils literal notranslate"><span class="pre">train_loop_per_worker</span></code> on multiple Ray
Actors. These actors already have the necessary torch process group
configured for distributed PyTorch training, as well as all environment variables
required by Accelerate, as defined in the configuration file. This allows you
to use Accelerate APIs (such as <code class="docutils literal notranslate"><span class="pre">Accelerator</span></code>) inside <code class="docutils literal notranslate"><span class="pre">train_loop_per_worker</span></code>
as you would without Ray.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">train_loop_per_worker</span></code> function, In addition to Accelerate APIs, you
can use any of the <a class="reference internal" href="../../../ray-air/api/session.html#air-session-ref"><span class="std std-ref">Ray AIR session methods</span></a>.
See full example code below.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_loop_per_worker</span><span class="p">():</span>
    <span class="c1"># Report intermediate results for callbacks or logging and</span>
    <span class="c1"># checkpoint data.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="c1"># Get dict of last saved checkpoint.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">get_checkpoint</span><span class="p">()</span>

    <span class="c1"># Session returns the Dataset shard for the given key.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">get_dataset_shard</span><span class="p">(</span><span class="s2">&quot;my_dataset&quot;</span><span class="p">)</span>

    <span class="c1"># Get the total number of workers executing training.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">get_world_size</span><span class="p">()</span>

    <span class="c1"># Get the rank of this worker.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">get_world_rank</span><span class="p">()</span>

    <span class="c1"># Get the rank of the worker on the current node.</span>
    <span class="n">session</span><span class="o">.</span><span class="n">get_local_rank</span><span class="p">()</span>
</pre></div>
</div>
<p>For more information, see the documentation of
<a class="reference internal" href="ray.train.torch.TorchTrainer.html#ray.train.torch.TorchTrainer" title="ray.train.torch.TorchTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchTrainer</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You need to use <code class="docutils literal notranslate"><span class="pre">session.report()</span></code> to communicate results and checkpoints
back to Ray Train.</p>
</div>
<p>Accelerate integrations with DeepSpeed, FSDP, MegatronLM etc. are fully supported.
If the Accelerate configuration contains a path to a DeepSpeed config file
(<code class="docutils literal notranslate"><span class="pre">deepspeed_config_file</span></code>), that file will also be loaded and applied on the
workers.</p>
<p>The following Accelerate configuration options will be ignored and automatically
set by the Trainer according to Ray AIR configs (eg. <code class="docutils literal notranslate"><span class="pre">ScalingConfig</span></code>):
- Number of machines (<code class="docutils literal notranslate"><span class="pre">num_machines</span></code>)
- Number of processes (<code class="docutils literal notranslate"><span class="pre">num_processes</span></code>)
- Rank of the current machine (<code class="docutils literal notranslate"><span class="pre">machine_rank</span></code>)
- Local rank of the current machine
- GPU IDs (<code class="docutils literal notranslate"><span class="pre">gpu_ids</span></code>)
- Number of CPU threads per process (<code class="docutils literal notranslate"><span class="pre">num_cpu_threads_per_process</span></code>)
- IP of the head process (<code class="docutils literal notranslate"><span class="pre">main_process_ip</span></code>)
- Port of the head process (<code class="docutils literal notranslate"><span class="pre">main_process_port</span></code>)
- Whether all machines are on the same network (<code class="docutils literal notranslate"><span class="pre">same_network</span></code>)
- Whether to force a CPU-only mode (<code class="docutils literal notranslate"><span class="pre">cpu</span></code>/<code class="docutils literal notranslate"><span class="pre">use_cpu</span></code>)
- rdzv backend (<code class="docutils literal notranslate"><span class="pre">rdzv_backend</span></code>)
- Main training function (<code class="docutils literal notranslate"><span class="pre">main_training_function</span></code>)
- Type of launcher</p>
<p>This Trainer requires <code class="docutils literal notranslate"><span class="pre">accelerate&gt;=0.17.0</span></code> package.
It is tested with <code class="docutils literal notranslate"><span class="pre">accelerate==0.17.1</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="kn">from</span> <span class="nn">accelerate</span> <span class="kn">import</span> <span class="n">Accelerator</span>

<span class="kn">import</span> <span class="nn">ray</span>
<span class="kn">from</span> <span class="nn">ray.air</span> <span class="kn">import</span> <span class="n">session</span><span class="p">,</span> <span class="n">Checkpoint</span>
<span class="kn">from</span> <span class="nn">ray.train.huggingface</span> <span class="kn">import</span> <span class="n">AccelerateTrainer</span>
<span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">ScalingConfig</span>
<span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">RunConfig</span>
<span class="kn">from</span> <span class="nn">ray.air.config</span> <span class="kn">import</span> <span class="n">CheckpointConfig</span>

<span class="c1"># If using GPUs, set this to True.</span>
<span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Define NN layers archicture, epochs, and number of workers</span>
<span class="n">input_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">layer_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">output_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">num_workers</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Define your network structure</span>
<span class="k">class</span> <span class="nc">NeuralNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NeuralNetwork</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="n">layer_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">layer_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="nb">input</span><span class="p">)))</span>

<span class="c1"># Define your train worker loop</span>
<span class="k">def</span> <span class="nf">train_loop_per_worker</span><span class="p">():</span>

    <span class="c1"># Initialize the Accelerator</span>
    <span class="n">accelerator</span> <span class="o">=</span> <span class="n">Accelerator</span><span class="p">()</span>

    <span class="c1"># Fetch training set from the session</span>
    <span class="n">dataset_shard</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_dataset_shard</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">()</span>

    <span class="c1"># Loss function, optimizer, prepare model for training.</span>
    <span class="c1"># This moves the data and prepares model for distributed</span>
    <span class="c1"># execution</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.01</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span> <span class="o">=</span> <span class="n">accelerator</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span>

    <span class="c1"># Iterate over epochs and batches</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">batches</span> <span class="ow">in</span> <span class="n">dataset_shard</span><span class="o">.</span><span class="n">iter_torch_batches</span><span class="p">(</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span>
        <span class="p">):</span>

            <span class="c1"># Add batch or unsqueeze as an additional dimension [32, x]</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">batches</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">batches</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

            <span class="c1"># Make output shape same as the as labels</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">labels</span><span class="p">)</span>

            <span class="c1"># Zero out grads, do backward, and update optimizer</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">accelerator</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># Print what&#39;s happening with loss per 30 epochs</span>
            <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_epochs</span><span class="si">}</span><span class="s2">, loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Report and record metrics, checkpoint model at end of each</span>
        <span class="c1"># epoch</span>
        <span class="n">session</span><span class="o">.</span><span class="n">report</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">},</span>
            <span class="n">checkpoint</span><span class="o">=</span><span class="n">Checkpoint</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">epoch</span><span class="o">=</span><span class="n">epoch</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">accelerator</span><span class="o">.</span><span class="n">unwrap_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">from_items</span><span class="p">(</span>
    <span class="p">[{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]</span>
<span class="p">)</span>

<span class="c1"># Define scaling and run configs</span>
<span class="n">scaling_config</span> <span class="o">=</span> <span class="n">ScalingConfig</span><span class="p">(</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">)</span>
<span class="n">run_config</span> <span class="o">=</span> <span class="n">RunConfig</span><span class="p">(</span><span class="n">checkpoint_config</span><span class="o">=</span><span class="n">CheckpointConfig</span><span class="p">(</span><span class="n">num_to_keep</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">AccelerateTrainer</span><span class="p">(</span>
    <span class="n">train_loop_per_worker</span><span class="o">=</span><span class="n">train_loop_per_worker</span><span class="p">,</span>
    <span class="c1"># Instead of using a dict, you can run ``accelerate config``.</span>
    <span class="c1"># The default value of None will then load that configuration</span>
    <span class="c1"># file.</span>
    <span class="n">accelerate_config</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">scaling_config</span><span class="o">=</span><span class="n">scaling_config</span><span class="p">,</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">run_config</span><span class="p">,</span>
    <span class="n">datasets</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_dataset</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">best_checkpoint_loss</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span>

<span class="c1"># Assert loss is less 0.09</span>
<span class="k">assert</span> <span class="n">best_checkpoint_loss</span> <span class="o">&lt;=</span> <span class="mf">0.09</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loop_per_worker</strong> – The training function to execute.
This can either take in no arguments or a <code class="docutils literal notranslate"><span class="pre">config</span></code> dict.</p></li>
<li><p><strong>train_loop_config</strong> – Configurations to pass into
<code class="docutils literal notranslate"><span class="pre">train_loop_per_worker</span></code> if it accepts an argument.</p></li>
<li><p><strong>accelerate_config</strong> – Accelerate configuration to be applied on every worker.
This can be a path to a file generated with <code class="docutils literal notranslate"><span class="pre">accelerate</span> <span class="pre">config</span></code>,
a configuration dict or None, in which case it will load the configuration
file from the default location as defined by Accelerate.</p></li>
<li><p><strong>torch_config</strong> – Configuration for setting up the PyTorch backend. If set to
None, use the default configuration. This replaces the <code class="docutils literal notranslate"><span class="pre">backend_config</span></code>
arg of <code class="docutils literal notranslate"><span class="pre">DataParallelTrainer</span></code>.</p></li>
<li><p><strong>scaling_config</strong> – Configuration for how to scale data parallel training.</p></li>
<li><p><strong>dataset_config</strong> – Configuration for dataset ingest.</p></li>
<li><p><strong>run_config</strong> – Configuration for the execution of the training run.</p></li>
<li><p><strong>datasets</strong> – Any Datasets to use for training. Use
the key “train” to denote which dataset is the training
dataset. If a <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> is provided and has not already been fit,
it will be fit on the training dataset. All datasets will be transformed
by the <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> if one is provided.</p></li>
<li><p><strong>preprocessor</strong> – A <code class="docutils literal notranslate"><span class="pre">ray.data.Preprocessor</span></code> to preprocess the
provided datasets.</p></li>
<li><p><strong>resume_from_checkpoint</strong> – A checkpoint to resume training from.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.can_restore.html#ray.train.huggingface.AccelerateTrainer.can_restore" title="ray.train.huggingface.AccelerateTrainer.can_restore"><code class="xref py py-obj docutils literal notranslate"><span class="pre">can_restore</span></code></a>(path)</p></td>
<td><p>Checks whether a given directory contains a restorable Train experiment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.fit.html#ray.train.huggingface.AccelerateTrainer.fit" title="ray.train.huggingface.AccelerateTrainer.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>()</p></td>
<td><p>Runs training.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.get_dataset_config.html#ray.train.huggingface.AccelerateTrainer.get_dataset_config" title="ray.train.huggingface.AccelerateTrainer.get_dataset_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dataset_config</span></code></a>()</p></td>
<td><p>Return a copy of this Trainer's final dataset configs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.restore.html#ray.train.huggingface.AccelerateTrainer.restore" title="ray.train.huggingface.AccelerateTrainer.restore"><code class="xref py py-obj docutils literal notranslate"><span class="pre">restore</span></code></a>(path[, train_loop_per_worker, ...])</p></td>
<td><p>Restores a DataParallelTrainer from a previously interrupted/failed run.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="ray.train.huggingface.AccelerateTrainer.setup.html#ray.train.huggingface.AccelerateTrainer.setup" title="ray.train.huggingface.AccelerateTrainer.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>()</p></td>
<td><p>Called during fit() to perform initial setup on the Trainer.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ray.train.huggingface.TransformersCheckpoint.uri.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">ray.train.huggingface.TransformersCheckpoint.uri</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ray.train.huggingface.AccelerateTrainer.can_restore.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ray.train.huggingface.AccelerateTrainer.can_restore</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2023, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js@digest=1999514e3f237ded88cf"></script>


  </body>
</html>